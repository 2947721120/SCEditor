(function(a){a.sceditor=function(g,k){var m=this;var F=a(g);var v=g;var i=null;var J=null;var u=null;var t=null;var l=null;var e=null;var f=false;var p=[];var b=null;var B=null;var h=[];var D,s,z,o,E,C,c,w,r,I,H,x,j,G,A,y,n,d,q;m.commands=a.sceditor.commands;D=function(){F.data("sceditor",m);m.options=a.extend({},a.sceditor.defaultOptions,k);if(m.options.locale!==null&&m.options.locale!=="en"){q()}if(m.options.height!==null){F.height(m.options.height)}if(m.options.width!==null){F.width(m.options.width)}if((m.options.height!==null&&m.options.height.toString().indexOf("%")>-1)||(m.options.width!==null&&m.options.width.toString().indexOf("%")>-1)){a(window).resize(y)}i=a('<div class="sceditor-container" />').width(F.outerWidth()).height(F.outerHeight());F.after(i);I();r();H();if(m.options.resizeEnabled){x()}F.parents("form").submit(m.updateTextareaValue);a(document).click(j);var K=F.hide().val();if(m.options.getTextHandler){K=m.options.getTextHandler(K)}m.setWysiwygEditorValue(K);G()};r=function(){l=a("<textarea></textarea>").hide();u=a('<iframe frameborder="0"></iframe>');if(window.location.protocol==="https:"){u.attr("src","javascript:false")}i.append(u).append(l);t=u[0];d(F.width());n(F.height());A().designMode="On";A().open();A().write('<html><head><link rel="stylesheet" type="text/css" href="'+m.options.style+'" /></head><body></body></html>');A().close();A().designMode="On";a(A()).find("body").keypress(c);a(A()).keypress(c);a(A()).mousedown(w);a(A()).bind("beforedeactivate keypress",C)};I=function(){var M=function(R){E(a(this),m.commands[a(this).data("sceditor-command")]);R.preventDefault()};J=a('<div class="sceditor-toolbar" />');var L=m.options.toolbar.split("|");for(var O=0;O<L.length;O++){var Q=a('<div class="sceditor-group" />');var P=L[O].split(",");for(var K=0;K<P.length;K++){if(!m.commands.hasOwnProperty(P[K])){continue}var N=a('<a class="sceditor-button sceditor-button-'+P[K]+' " unselectable="on"><div unselectable="on" /></a>');if(m.commands[P[K]].hasOwnProperty("tooltip")){N.attr("title",m._(m.commands[P[K]].tooltip))}N.data("sceditor-command",P[K]);N.click(M);Q.append(N)}J.append(Q)}if(m.options.toolbarContainer===null){i.append(J)}else{a(m.options.toolbarContainer).append(J)}};H=function(){a.each(m.commands,function(L,K){if(typeof K.keyPress!=="undefined"){p.push(K.keyPress)}})};d=function(K){i.width(K);u.width(K);u.width(K+(K-u.outerWidth(true)));l.width(K);l.width(K+(K-l.outerWidth(true)))};n=function(K){i.height(K);K=K-(m.options.toolbarContainer===null?J.outerHeight():0);u.height(K);u.height(K+(K-u.outerHeight(true)));l.height(K);l.height(K+(K-l.outerHeight(true)))};x=function(){var M=a('<div class="sceditor-grip" />'),X=a('<div class="sceditor-resize-cover" />'),P=0,N=0,O=0,V=0,U=i.width(),W=i.height(),S=false,T,R,K,Q,L;T=(m.options.resizeMinHeight==null?W/2:m.options.resizeMinHeight);R=(m.options.resizeMaxHeight==null?W*2:m.options.resizeMaxHeight);K=(m.options.resizeMinWidth==null?U/2:m.options.resizeMinWidth);Q=(m.options.resizeMaxWidth==null?U*2:m.options.resizeMaxWidth);L=function(aa){var Y=V+(aa.pageY-N);var Z=O+(aa.pageX-P);if(Z>=K&&(K<0||Z<=Q)){d(Z)}if(Y>=T&&(R<0||Y<=R)){n(Y)}aa.preventDefault()};i.append(M);i.append(X.hide());M.mousedown(function(Y){P=Y.pageX;N=Y.pageY;O=i.width();V=i.height();S=true;X.show();a(document).bind("mousemove",L);Y.preventDefault()});a(document).mouseup(function(Y){if(!S){return}S=false;X.hide();a(document).unbind("mousemove",L);Y.preventDefault()})};G=function(){var K=a.extend({},m.options.emoticons.more,m.options.emoticons.dropdown,m.options.emoticons.hidden);a.each(K,function(N,L){var M=document.createElement("img");M.src=L;h.push(M)})};m.createDropDown=function(K,N,M,L){m.closeDropDown();if(L!==false){M=a(M);M.find(":not(input,textarea)").filter(function(){return this.nodeType===1}).attr("unselectable","on")}e=a('<div class="sceditor-dropdown sceditor-'+N+'" />').css({top:K.offset().top,left:K.offset().left}).append(M);e.appendTo(a("body"));f=true;e.click(function(O){O.stopPropagation()})};j=function(){if(!f){m.closeDropDown()}f=false};m.closeDropDown=function(K){if(e!==null){e.remove();e=null}if(K===true){m.focus()}};A=function(){if(t.contentDocument){return t.contentDocument}if(t.contentWindow&&t.contentWindow.document){return t.contentWindow.document}if(t.document){return t.document}return null};m.wysiwygEditorInsertHtml=function(L,N){m.focus();if(a(s()).is("code")||a(s()).parents("code").length!==0){return}if(typeof N!=="undefined"){L=L+m.getWysiwygSelectedHtml()+N}if(A().getSelection){var K=z();var M=A().createElement("div");M.innerHTML=L;M=M.children[0];K.deleteContents();K.insertNode(M);K=K.cloneRange();if(M.parentNode!==K.startContainer||!a.browser.opera){K.setStartAfter(M)}else{return}t.contentWindow.getSelection().removeAllRanges();t.contentWindow.getSelection().addRange(K)}else{if(A().selection&&A().selection.createRange){A().selection.createRange().pasteHTML(L)}else{m.execCommand("insertHtml",L)}}b=null};m.wysiwygEditorInsertText=function(K){K=K.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />");m.wysiwygEditorInsertHtml("<span>"+K+"</span>")};z=function(){var K;if(t.contentWindow&&t.contentWindow.getSelection){K=t.contentWindow.getSelection()}else{if(A().selection){K=A().selection}}if(K.getRangeAt&&K.rangeCount<=0){K.addRange(A().createRange())}if(K.getRangeAt){return K.getRangeAt(0)}else{if(K.createRange){return K.createRange()}}return null};m.getWysiwygSelectedHtml=function(){var L=z();if(L===null){return""}if(document.selection&&document.selection.createRange){if(L.text===""){return""}if(typeof L.htmlText!=="undefined"){return L.htmlText}}if(window.XMLSerializer){var K="";a(L.cloneContents().childNodes).each(function(){K+=new XMLSerializer().serializeToString(this)});return K}};s=function(){var K=z();if(K===null){return null}if(window.getSelection&&typeof K.commonAncestorContainer!=="undefined"){return K.commonAncestorContainer}if(document.selection&&document.selection.createRange){return K.parentElement()}};m.getWysiwygEditorValue=function(L){var K=u.contents().find("body").html();if(L!==false&&m.options.getHtmlHandler){K=m.options.getHtmlHandler(K,u.contents().find("body"))}return K};m.getTextareaValue=function(K){var L=l.val();if(K!==false&&m.options.getTextHandler){L=m.options.getTextHandler(L)}return L};m.setWysiwygEditorValue=function(K){A().body.innerHTML=o(K)};m.setTextareaValue=function(K){l.val(K)};m.updateTextareaValue=function(){if(l.is(":visible")){F.val(m.getTextareaValue(false))}else{F.val(m.getWysiwygEditorValue())}};o=function(K){var L=a.extend({},m.options.emoticons.more,m.options.emoticons.dropdown,m.options.emoticons.hidden);a.each(L,function(N,M){var O=N.replace(/[\$\?\[\]\.\*\(\)\|]/g,"\\$&").replace("<","&lt;").replace(">","&gt;")+"(?=([^\\<\\>]*?<(?!/code)|[^\\<\\>]*?$))";K=K.replace(new RegExp(O,"g"),'<img src="'+M+'" data-sceditor-emoticon="'+N+'" />')});return K};m.toggleTextMode=function(){if(l.is(":visible")){m.setWysiwygEditorValue(m.getTextareaValue())}else{m.setTextareaValue(m.getWysiwygEditorValue())}b=null;l.toggle();u.toggle()};E=function(K,L){if(!L.hasOwnProperty("exec")){return}if(a.isFunction(L.exec)){L.exec.call(m,K)}else{m.execCommand(L.exec,L.hasOwnProperty("execParam")?L.execParam:null)}};m.focus=function(){C();t.contentWindow.focus();if(b!==null){if(window.document.createRange){window.getSelection().addRange(b)}else{if(window.document.selection){b.select()}}}};C=function(){if(!a.browser.msie){return}b=z()};m.execCommand=function(N,M){var K=false;m.focus();if(a(s()).is("code")||a(s()).parents("code").length!==0){return}if(A()){try{K=A().execCommand(N,false,M)}catch(L){}}if(!K&&typeof m.commands[N]!=="undefined"&&typeof m.commands[N].errorMessage!=="undefined"){alert(m._(m.commands[N].errorMessage))}};c=function(L){m.closeDropDown();if(a(s()).is("code")||a(s()).parents("code").length!==0){return}var K=p.length;while(K--){p[K].call(m,L,t,l)}};w=function(K){m.closeDropDown()};y=function(){if(m.options.height!==null&&m.options.height.toString().indexOf("%")>-1){n(i.parent().height()*(parseFloat(m.options.height)/100))}if(m.options.width!==null&&m.options.width.toString().indexOf("%")>-1){d(i.parent().width()*(parseFloat(m.options.width)/100))}};m._=function(){var K=arguments;if(B!==null&&B[K[0]]){K[0]=B[K[0]]}return K[0].replace(/\{(\d+)\}/g,function(M,L){return typeof K[L-0+1]!="undefined"?K[L-0+1]:"{"+L+"}"})};q=function(){if(a.sceditor.locale[m.options.locale]){B=a.sceditor.locale[m.options.locale]}else{var K=m.options.locale.split("-");if(a.sceditor.locale[K[0]]){B=a.sceditor.locale[K[0]]}}if(B!==null&&B.dateFormat){m.options.dateFormat=B.dateFormat}};D()};a.sceditor.locale={};a.sceditor.commands={bold:{exec:"bold",tooltip:"Bold"},italic:{exec:"italic",tooltip:"Italic"},underline:{exec:"underline",tooltip:"Underline"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{exec:function(c){var e=this;var g=e.options.fonts.split(",");var f=a("<div />");var b=function(h){e.execCommand("fontname",a(this).data("sceditor-font"));e.closeDropDown(true);h.preventDefault()};for(var d=0;d<g.length;d++){f.append(a('<a class="sceditor-font-option" href="#"><font face="'+g[d]+'">'+g[d]+"</font></a>").data("sceditor-font",g[d]).click(b))}e.createDropDown(c,"font-picker",f)},tooltip:"Font Name"},size:{exec:function(c){var e=this;var f=a("<div />");var b=function(g){e.execCommand("fontsize",a(this).data("sceditor-fontsize"));e.closeDropDown(true);g.preventDefault()};for(var d=1;d<=7;d++){f.append(a('<a class="sceditor-fontsize-option" href="#"><font size="'+d+'">'+d+"</font></a>").data("sceditor-fontsize",d).click(b))}e.createDropDown(c,"fontsize-picker",f)},tooltip:"Font Size"},color:{exec:function(d){var j=this;var c={r:255,g:255,b:255};var k=a("<div />");var g=this.options.colors?this.options.colors.split("|"):new Array(21);var h=[];var m=0;for(var f=0;f<g.length;++f){var b=(typeof g[f]!=="undefined")?g[f].split(","):new Array(21);h[m++]='<div class="sceditor-color-column">';for(var l=0;l<b.length;++l){var e=(typeof b[l]!=="undefined")?b[l]:"#"+c.r.toString(16)+c.g.toString(16)+c.b.toString(16);h[m++]='<a href="#" class="sceditor-color-option" style="background-color: '+e+'" data-color="'+e+'"></a>';if(l%5===0){c={r:c.r,g:c.g-51,b:255}}else{c={r:c.r,g:c.g,b:c.b-51}}}h[m++]="</div>";if(f%5===0){c={r:c.r-51,g:255,b:255}}else{c={r:c.r,g:255,b:255}}}k.append(h.join("")).find("a").click(function(i){j.execCommand("forecolor",a(this).attr("data-color"));j.closeDropDown(true);i.preventDefault()});j.createDropDown(d,"color-picker",k)},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(b){var c=this;var d=a(this._('<form><div><label for="txt">{0}</label> <textarea cols="20" rows="7" id="txt"></textarea></div></form>',this._("Paste your text inside the following box:"))).submit(function(){return false});d.append(a(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(f){c.wysiwygEditorInsertText(a(this).parent("form").find("#txt").val());c.closeDropDown(true);f.preventDefault()}));c.createDropDown(b,"pastetext",d)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},undo:{exec:"undo",tooltip:"Undo"},redo:{exec:"redo",tooltip:"Redo"},table:{exec:function(b){var c=this;var d=a(this._('<form><div><label for="rows">{0}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{1}</label><input type="text" id="cols" value="2" /></div></form>',this._("Rows:"),this._("Cols:"))).submit(function(){return false});d.append(a(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(j){var h=a(this).parent("form").find("#rows").val()-0;var i=a(this).parent("form").find("#cols").val()-0;var g="<table>";for(var k=0;k<h;k++){g+="<tr>";for(var f=0;f<i;f++){if(a.browser.msie){g+="<td></td>"}else{g+='<td><br class="sceditor-ignore" /></td>'}}g+="</tr>"}g+="</table>";c.wysiwygEditorInsertHtml(g);c.closeDropDown(true);j.preventDefault()}));c.createDropDown(b,"inserttable",d)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(b){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{exec:function(b){var c=this;var d=a(this._('<form><div><label for="link">{0}</label> <input type="text" id="image" value="http://" /></div><div><label for="width">{1}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{2}</label> <input type="text" id="height" size="2" /></div></form>',this._("URL:"),this._("Width (optional):"),this._("Height (optional):"))).submit(function(){return false});d.append(a(this._('<div><input type="button" class="button" value="Insert" /></div>',this._("Insert"))).click(function(j){var g=a(this).parent("form");var k=g.find("#image").val();var h="";var i,f;if((i=g.find("#width").val())!==""){h+=' width="'+i+'"'}if((f=g.find("#height").val())!==""){h+=' height="'+f+'"'}if(k!==""&&k!=="http://"){c.wysiwygEditorInsertHtml("<img"+h+' src="'+k+'" />')}c.closeDropDown(true);j.preventDefault()}));c.createDropDown(b,"insertimage",d)},tooltip:"Insert an image"},email:{exec:function(b){var c=this;var d=a(this._('<form><div><label for="email">{0}</label> <input type="text" id="email" value="" /></div></form>',this._("E-mail:"))).submit(function(){return false});d.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(f){var g=a(this).parent("form").find("#email").val();if(g!==""){c.focus();if(c.getWysiwygSelectedHtml()==""){c.wysiwygEditorInsertHtml('<a href="mailto:'+g+'">'+g+"</a>")}else{c.execCommand("createlink","mailto:"+g)}}c.closeDropDown(true);f.preventDefault()}));c.createDropDown(b,"insertemail",d)},tooltip:"Insert an email"},link:{exec:function(b){var c=this;var d=a(this._('<form><div><label for="link">{0}</label> <input type="text" id="link" value="http://" /></div></form>',this._("URL:"))).submit(function(){return false});d.append(a(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(f){var g=a(this).parent("form").find("#link").val();if(g!==""&&g!=="http://"){c.focus();if(c.getWysiwygSelectedHtml()==""){c.wysiwygEditorInsertHtml('<a href="'+g+'">'+g+"</a>")}else{c.execCommand("createlink",g)}}c.closeDropDown(true);f.preventDefault()}));c.createDropDown(b,"insertlink",d)},tooltip:"Insert a link"},unlink:{exec:"unlink",tooltip:"Unlink"},quote:{exec:function(b,c){c=c||"<br />";this.wysiwygEditorInsertHtml("<blockquote>"+c+"</blockquote>")},tooltip:"Insert a Quote"},emoticon:{exec:function(d){var f=this;var g=a("<div />");var b=a("<div />");var c=function(i,h){b.append(a("<img />").attr({src:h,alt:i}).click(function(j){f.wysiwygEditorInsertHtml('<img src="'+a(this).attr("src")+'" data-sceditor-emoticon="'+a(this).attr("alt")+'" />');f.closeDropDown(true);j.preventDefault()}));if(b.children().length>3){g.append(b);b=a("<div />")}};a.each(f.options.emoticons.dropdown,c);if(b.children().length>0){g.append(b)}if(typeof f.options.emoticons.more!=="undefined"){var e=a(this._('<a class="sceditor-more">{0}</a>',this._("More"))).click(function(){var h=a.extend({},f.options.emoticons.dropdown,f.options.emoticons.more);g=a("<div />");b=a("<div />");a.each(h,c);if(b.children().length>0){g.append(b)}f.createDropDown(d,"insertemoticon",g)});g.append(e)}f.createDropDown(d,"insertemoticon",g)},keyPress:function(f,g){var b=null,h=-1,d=this;if(g.contentWindow&&g.contentWindow.getSelection){b=g.contentWindow.getSelection().getRangeAt(0)}if(b==null||!b.startContainer){return}if(!d.allEmoticonCache){d.allEmoticonCache=a.extend({},d.options.emoticons.more,d.options.emoticons.dropdown,d.options.emoticons.hidden)}if(!d.longestEmoticonCode){d.longestEmoticonCode=0;a.each(d.allEmoticonCache,function(i,e){if(i.length>d.longestEmoticonCode){d.longestEmoticonCode=i.length}})}var c=b.startContainer.textContent.substr(0,b.startOffset)+String.fromCharCode(f.which)+b.startContainer.textContent.substr(b.startOffset,d.longestEmoticonCode);a.each(d.allEmoticonCache,function(i,e){if((h=c.indexOf(i))>-1){b=b.cloneRange();b.setStart(b.startContainer,h);b.setEnd(b.startContainer,h+(i.length-1));b.deleteContents();var j=g.contentDocument.createElement("div");j.innerHTML='<img src="'+e+'" data-sceditor-emoticon="'+i+'" />';j=j.children[0];b.insertNode(j);b=b.cloneRange();b.setStartAfter(j);g.contentWindow.getSelection().removeAllRanges();g.contentWindow.getSelection().addRange(b);f.preventDefault();f.stopPropagation();return false}})},tooltip:"Insert an emoticon"},youtube:{exec:function(b){var c=this;var d=a(this._('<form><div><label for="link">{0}</label> <input type="text" id="link" value="http://" /></div></form>',this._("Video URL:"))).submit(function(){return false});d.append(a(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(f){var g=a(this).parent("form").find("#link").val();if(g!==""&&g!=="http://"){g=g.replace(/^[^v]+v.(.{11}).*/,"$1");c.wysiwygEditorInsertHtml('<iframe width="560" height="315" src="http://www.youtube.com/embed/'+g+'" data-youtube-id="'+g+'" frameborder="0" allowfullscreen></iframe>')}c.closeDropDown(true);f.preventDefault()}));c.createDropDown(b,"insertlink",d)},tooltip:"Insert a YouTube video"},date:{exec:function(d){var c=new Date();var e=c.getYear();var f=c.getMonth()+1;var b=c.getDate();if(e<2000){e=1900+e}if(f<10){f="0"+f}if(b<10){b="0"+b}this.wysiwygEditorInsertHtml("<span>"+this.options.dateFormat.replace(/year/i,e).replace(/month/i,f).replace(/day/i,b)+"</span>")},tooltip:"Insert current date"},time:{exec:function(d){var c=new Date();var b=c.getHours();var f=c.getMinutes();var e=c.getSeconds();if(b<10){b="0"+b}if(f<10){f="0"+f}if(e<10){e="0"+e}this.wysiwygEditorInsertHtml("<span>"+b+":"+f+":"+e+"</span>")},tooltip:"Insert current time"},print:{exec:"print",tooltip:"Print"},source:{exec:function(b){this.toggleTextMode()},tooltip:"View source"}};a.sceditor.commandExists=function(b){return typeof a.sceditor.commands[b]!=="undefined"};a.sceditor.setCommand=function(d,b,e,c){if(!d||!b){return false}if(!a.sceditor.commandExists(d)){a.sceditor.commands[d]={}}a.sceditor.commands[d].exec=b;if(e){a.sceditor.commands[d].tooltip=e}if(c){a.sceditor.commands[d].keypress=c}return true};a.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|undo,redo|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|print,source",style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:"en",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:true,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null};a.fn.sceditor=function(b){return this.each(function(){(new a.sceditor(this,b))})}})(jQuery);(function(a){a.sceditorBBCodePlugin=function(e,k){var c=this;var j,f,g,d,i;c.bbcodes=a.sceditorBBCodePlugin.bbcodes;var h={};var b={};j=function(){c.options=a.extend({},a.sceditor.defaultOptions,a.sceditorBBCodePlugin.defaultOptions,k);c.buildBbcodeCache();(new a.sceditor(e,a.extend({},c.options,{getHtmlHandler:c.getHtmlHandler,getTextHandler:c.getTextHandler})))};c.buildBbcodeCache=function(){a.each(c.bbcodes,function(l,m){if(typeof c.bbcodes[l].tags!=="undefined"){a.each(c.bbcodes[l].tags,function(n,o){h[n]=(h[n]||{});h[n][l]=o})}if(typeof c.bbcodes[l].styles!=="undefined"){a.each(c.bbcodes[l].styles,function(o,n){b[o]=(b[o]||{});b[o][l]=n})}})};f=function(m,n){var l;a.each(b,function(p,o){if(m.get(0).nodeName.toLowerCase()==="a"&&(p==="color"||p==="text-decoration")){return}else{if(m.get(0).nodeName.toLowerCase()==="code"&&(p==="font-family")){return}}l=m.css(p);if(m.parent().css(p)==l){return}a.each(o,function(r,q){if(q===null||a.inArray(l.toString(),q)>-1){if(a.isFunction(c.bbcodes[r].format)){n=c.bbcodes[r].format.call(c,m,n)}else{n=d(c.bbcodes[r].format,n)}}})});return n};g=function(m,n){var l=m.get(0).nodeName.toLowerCase();if(m.hasClass("sceditor-ignore")){return n}if(typeof h[l]!=="undefined"){a.each(h[l],function(p,q){if(q!==null){var o=false;a.each(q,function(s,r){if(typeof m.attr(s)==="undefined"){return}if(r!==null&&a.inArray(m.attr(s),r)<0){return}o=true;return false});if(!o){return}}if(a.isFunction(c.bbcodes[p].format)){n=c.bbcodes[p].format.call(c,m,n)}else{n=d(c.bbcodes[p].format,n)}})}if(l==="br"||l==="div"||l==="p"){n+="\n"}return n};d=function(){var l=arguments;return l[0].replace(/\{(\d+)\}/g,function(n,m){return typeof l[m-0+1]!="undefined"?l[m-0+1]:"{"+m+"}"})};c.stripQuotes=function(l){return l.replace(/^["']+/,"").replace(/["']+$/,"")};c.getHtmlHandler=function(l,m){return c.elementToBbcode(a(m))};c.elementToBbcode=function(m){var l="";if(typeof m.get(0)==="undefined"){return""}if(m.get(0).nodeName.toLowerCase()!=="iframe"){if(m.get(0).nodeType===3){return m.get(0).nodeValue}else{if(m.is("code")){l=i(m)}else{if(m.contents().length>0){a.each(m.contents(),function(){l+=c.elementToBbcode(a(this))})}}}}if(!m.is("code")){l=f(m,l)}l=g(m,l);return l};i=function(m){var l="";if(typeof m.get(0)==="undefined"){return""}if(m.get(0).nodeType===3){return m.get(0).nodeValue}else{if(m.is("br")){l="\n"}else{if(m.contents().length>0){a.each(m.contents(),function(){l+=i(a(this))})}}}return l};c.getTextHandler=function(p){var o=/\[([^\[\s=]*?)(?:([^\[]*?))?\]((?:[\s\S(?!=\[\\\1)](?!\[\1))*?)\[\/(\1)\]/g;var m=/(\S+)=((?:(?:(["'])(?:\\\3|[^\3])*?\3))|(?:[^'"\s]+))/g;var l;var n=function(v,r,q,t){var s={};if(typeof q!=="undefined"){var u;q=a.trim(q);if((q.charAt(0)=="="&&(q.split("=").length-1)<=1)||r==="url"){s.defaultAttr=c.stripQuotes(q.substr(1))}else{if(q.charAt(0)==="="){q="defaultAttr"+q}while((u=m.exec(q))){s[u[1].toLowerCase()]=c.stripQuotes(u[2])}}}if(typeof c.bbcodes[r]==="undefined"){return v}if(typeof c.bbcodes[r].html==="function"){return c.bbcodes[r].html.call(c,r,s,t)}else{return d(c.bbcodes[r].html,t)}};p=p.replace(/&/g,"&amp;");p=p.replace(/</g,"&lt;");p=p.replace(/>/g,"&gt;");p=p.replace(/\r/g,"");p=p.replace(/(\[\/?(?:left|center|right|justify)\])\n/g,"$1");p=p.replace(/\n/g,"<span><br /></span>");while(p!==l){l=p;p=p.replace(o,n)}p=p.replace(/\[hr\]/gi,"<hr>");return p.replace(/ {2}(?=([^<\>]*?<|[^<\>]*?$))/g," &nbsp;")};j()};a.sceditorBBCodePlugin.bbcodes={b:{styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},left:{styles:{"text-align":["left"]},format:"[left]{0}[/left]",html:'<div style="text-align: left">{0}</div>'},center:{styles:{"text-align":["center"]},format:"[center]{0}[/center]",html:'<div style="text-align: center">{0}</div>'},right:{styles:{"text-align":["right"]},format:"[right]{0}[/right]",html:'<div style="text-align: right">{0}</div>'},justify:{styles:{"text-align":["justify"]},format:"[justify]{0}[/justify]",html:'<div style="text-align: justify">{0}</div>'},font:{styles:{"font-family":null},format:function(b,c){if(b.css("font-family")==this.options.defaultFont){return c}return"[font="+this.stripQuotes(b.css("font-family"))+"]"+c+"[/font]"},html:function(c,b,d){return'<font face="'+b.defaultAttr+'">'+d+"</font>"}},size:{styles:{"font-size":null},format:function(c,d){var e=c.css("fontSize");var b=1;if(e==this.options.defaultSize){return d}if(e.indexOf("px")>-1){e=e.replace("px","")-0;if(e>12){b=2}if(e>15){b=3}if(e>17){b=4}if(e>23){b=5}if(e>31){b=6}if(e>47){b=7}}else{b=e}return"[size="+b+"]"+d+"[/size]"},html:function(c,b,d){return'<font size="'+b.defaultAttr+'">'+d+"</font>"}},color:{styles:{color:null},format:function(c,e){var d=function(h){var g;function f(i){i=parseInt(i,10);if(isNaN(i)){return"00"}i=Math.max(0,Math.min(i,255)).toString(16);return i.length<2?"0"+i:i}if((g=h.match(/rgb\((\d+),\s*?(\d+),\s*?(\d+)\)/i))){return"#"+f(g[1])+f(g[2]-0)+f(g[3]-0)}return h};var b=d(c.css("color"));if(b==this.options.defaultColor){return e}return"[color="+b+"]"+e+"[/color]"},html:function(c,b,d){return'<font color="'+b.defaultAttr+'">'+d+"</font>"}},ul:{tags:{ul:null},format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{html:"<ul>{0}</ul>"},ol:{tags:{ol:null},format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{html:"<li>{0}</li>"},table:{tags:{table:null},format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},format:"[td]{0}[/td]",html:'<td>{0}<br class="sceditor-ignore" /></td>'},emoticon:{tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(b,c){return b.attr("data-sceditor-emoticon")+c},html:"{0}"},horizontalrule:{tags:{hr:null},format:"[hr]{0}",html:"<hr />"},img:{tags:{img:{src:null}},format:function(b,c){if(typeof b.attr("data-sceditor-emoticon")!="undefined"){return c}var d="="+a(b).width()+"x"+a(b).height();return"[img"+d+"]"+b.attr("src")+"[/img]"},html:function(c,b,d){var f="";if(typeof b.width!="undefined"){f+=' width="'+b.width+'"'}if(typeof b.height!="undefined"){f+=' height="'+b.height+'"'}if(typeof b.defaultAttr!=="undefined"){var e=b.defaultAttr.split(/x/i);f=' width="'+e[0]+'" height="'+(e.length===2?e[1]:e[0])+'"'}return"<img "+f+' src="'+d+'" />'}},url:{tags:{a:{href:null}},format:function(b,c){if(b.attr("href").substr(0,7)=="mailto:"){return"[email="+b.attr("href").substr(7)+"]"+c+"[/email]"}return"[url="+encodeURI(b.attr("href"))+"]"+c+"[/url]"},html:function(c,b,d){if(typeof b.defaultAttr==="undefined"){b.defaultAttr=d}return'<a href="'+b.defaultAttr+'">'+d+"</a>"}},email:{html:function(c,b,d){if(typeof b.defaultAttr==="undefined"){b.defaultAttr=d}return'<a href="mailto:'+b.defaultAttr+'">'+d+"</a>"}},quote:{tags:{blockquote:null},format:function(c,d){var b="";if(a(c).children("cite:first").length==1){b="="+a(c).children("cite:first").text();d="";a(c).children("cite:first").remove();a(c).contents().each(function(){d+=base.elementToBbcode(a(this))})}return"[quote"+b+"]"+d+"[/quote]"},html:function(c,b,d){if(typeof b.defaultAttr!=="undefined"){d="<cite>"+b.defaultAttr+"</cite>"+d}return"<blockquote>"+d+"</blockquote>"}},code:{tags:{code:null},format:"[code]{0}[/code]",html:"<code>{0}</code>"},youtube:{tags:{iframe:{"data-youtube-id":null}},format:function(b,c){if(!b.attr("data-youtube-id")){return c}return"[youtube]"+b.attr("data-youtube-id")+"[/youtube]"},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'}};a.sceditorBBCodePlugin.commandExists=function(b){return typeof a.sceditorBBCodePlugin.bbcodes[b]!=="undefined"};a.sceditorBBCodePlugin.setCommand=function(c,b,e,f,d){if(!c||!f||!d){return false}if(!a.sceditorBBCodePlugin.commandExists(c)){a.sceditorBBCodePlugin.bbcodes[c]={}}a.sceditorBBCodePlugin.bbcodes[c].format=f;a.sceditorBBCodePlugin.bbcodes[c].html=d;if(b){a.sceditorBBCodePlugin.bbcodes[c].tags=b}if(e){a.sceditorBBCodePlugin.bbcodes[c].styles=e}return true};a.sceditorBBCodePlugin.defaultOptions={defaultSize:13,defaultColor:"#111111",defaultFont:"Verdana, Arial, Helvetica, sans-serif"};a.fn.sceditorBBCodePlugin=function(b){return this.each(function(){(new a.sceditorBBCodePlugin(this,b))})}})(jQuery);