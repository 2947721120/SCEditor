/*! SCEditor | (C) 2011-2013, Sam Clarke | sceditor.com/license */
(function(e,t,n){"use strict";var o={html:'<!DOCTYPE html><html><head><style>.ie * {min-height: auto !important}</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true"></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="link">{url}</label> <input type="text" id="image" value="http://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" value="http://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" value="http://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{id}?wmode=opaque" data-youtube-id="{id}" frameborder="0" allowfullscreen></iframe>'},i=function(t,n,i){var r=o[t];return e.each(n,function(e,t){r=r.replace(RegExp("\\{"+e+"\\}","g"),t)}),i&&(r=e(r)),r};e.sceditor=function(o,r){var s,a,c,l,d,u,p,f,h,g,m,v,y,b,x,w,C,k,S,E,D,T,M,H,R,z,O,N,I,P,W,_,A,L,F,B,V,q,j,$,U,Y,X,Q,K,G,J,Z=this,et=o.get?o.get(0):o,tt=e(et),nt=[],ot=[],it=[],rt=[];Z.commands=e.extend(!0,{},r.commands||e.sceditor.commands),Z.opts=r=e.extend({},e.sceditor.defaultOptions,r),k=function(){tt.data("sceditor",Z),e.each(r,function(t,n){e.isPlainObject(n)&&(r[t]=e.extend(!0,{},n))}),r.locale&&"en"!==r.locale&&H(),s=e('<div class="sceditor-container" />').insertAfter(tt).css("z-index",r.zIndex),e.sceditor.ie&&s.addClass("ie ie"+e.sceditor.ie),w=!!tt.attr("required"),tt.removeAttr("required"),M(),P(),R(),T(),N(),z(),O(),e.sceditor.isWysiwygSupported||Z.toggleSourceMode();var o=function(){e(t).unbind("load",o),r.autofocus&&G(),r.autoExpand&&Z.expandToContent(),j()};e(t).load(o),n.readyState&&"complete"===n.readyState&&o(),U(),v.call("ready")},M=function(){var t=r.plugins;t=t?(""+t).split(","):[],v=new e.sceditor.PluginManager(Z),e.each(t,function(t,n){v.register(e.trim(n))})},H=function(){var t;e.sceditor.locale[r.locale]?h=e.sceditor.locale[r.locale]:(t=r.locale.split("-"),e.sceditor.locale[t[0]]&&(h=e.sceditor.locale[t[0]])),h&&h.dateFormat&&(r.dateFormat=h.dateFormat)},T=function(){var n,o,a,p;d=e("<textarea></textarea>").hide(),c=e('<iframe frameborder="0"></iframe>'),"https:"===t.location.protocol&&c.attr("src","javascript:false"),s.append(c).append(d),l=c[0],u=d[0],Z.width(r.width||tt.width()),Z.height(r.height||tt.height()),o=W(),a=e(o),o.open(),o.write(i("html",{charset:r.charset,style:r.style})),o.close(),Z.readOnly(!!r.readOnly),n=a.find("body"),e.sceditor.ie&&a.find("html").addClass("ie ie"+e.sceditor.ie),(/iPhone|iPod|iPad| wosbrowser\//i.test(navigator.userAgent)||e.sceditor.ie)&&(n.height("100%"),e.sceditor.ie||n.bind("touchend",Z.focus)),g=new e.sceditor.rangeHelper(l.contentWindow),Z.val(tt.hide().val()),p=tt.attr("tabindex"),d.attr("tabindex",p),c.attr("tabindex",p)},z=function(){var t=e(W()),n=t.find("body");r.autoUpdate&&(n.bind("blur",Z.updateOriginal),d.bind("blur",Z.updateOriginal)),null===r.rtl&&(r.rtl="rtl"===d.css("direction")),Z.rtl(!!r.rtl),r.autoExpand&&t.bind("keyup",Z.expandToContent),r.resizeEnabled&&I(),s.attr("id",r.id),Z.emoticons(r.emoticonsEnabled)},O=function(){var o=e(W());e(n).click(q),e(et.form).bind("reset",F).submit(Z.updateOriginal),e(t).bind("resize orientationChanged",j),o.find("body").keypress(L).keyup(X).bind("paste",_).bind(e.sceditor.ie?"selectionchange":"keyup focus blur contextmenu mouseup touchend click",Q).bind("keydown keyup keypress focus blur contextmenu",V),d.bind("keydown keyup keypress focus blur contextmenu",V),o.keypress(L).mousedown(B).bind(e.sceditor.ie?"selectionchange":"focus blur contextmenu mouseup click",Q).bind("beforedeactivate keyup",D).keyup(X).focus(function(){f=null}),s.bind("selectionchanged",U).bind("selectionchanged",K).bind("selectionchanged",V).bind("nodechanged",V)},R=function(){var t,n,o=(r.toolbarExclude||"").split(","),c=r.toolbar.split("|");a=e('<div class="sceditor-toolbar" unselectable="on" />'),e.each(c,function(r,s){t=e('<div class="sceditor-group" />'),e.each(s.split(","),function(r,s){!Z.commands[s]||e.inArray(s,o)>-1||(n=i("toolbarButton",{name:s,dispName:Z._(Z.commands[s].tooltip||s)},!0),n.data("sceditor-txtmode",!!Z.commands[s].txtExec),n.data("sceditor-wysiwygmode",!!Z.commands[s].exec),n.click(function(){var t=e(this);return t.hasClass("disabled")||E(t,Z.commands[s]),U(),!1}),Z.commands[s].tooltip&&n.attr("title",Z._(Z.commands[s].tooltip)),Z.commands[s].exec||n.addClass("disabled"),t.append(n))}),t[0].firstChild&&a.append(t)}),r.toolbarContainer?e(r.toolbarContainer).append(a):s.append(a)},N=function(){e.each(Z.commands,function(t,n){n.keyPress&&nt.push(n.keyPress),n.forceNewLineAfter&&e.isArray(n.forceNewLineAfter)&&(it=e.merge(it,n.forceNewLineAfter)),n.state?rt.push({name:t,state:n.state}):"string"==typeof n.exec&&rt.push({name:t,state:n.exec})})},I=function(){var o,i,a,c,l,d,u=e('<div class="sceditor-grip" />'),p=e('<div class="sceditor-resize-cover" />'),f=0,h=0,g=0,m=0,v=s.width(),y=s.height(),b=!1,x=Z.rtl();o=r.resizeMinHeight||y/1.5,i=r.resizeMaxHeight||2.5*y,a=r.resizeMinWidth||v/1.25,c=r.resizeMaxWidth||1.25*v,l=function(n){"touchmove"===n.type&&(n=t.event);var l=m+(n.pageY-h),d=x?g-(n.pageX-f):g+(n.pageX-f);c>0&&d>c&&(d=c),i>0&&l>i&&(l=i),(!r.resizeWidth||a>d||c>0&&d>c)&&(d=!1),(!r.resizeHeight||o>l||i>0&&l>i)&&(l=!1),(d||l)&&(Z.dimensions(d,l),7>e.sceditor.ie&&s.height(l)),n.preventDefault()},d=function(t){b&&(b=!1,p.hide(),s.removeClass("resizing").height("auto"),e(n).unbind("touchmove mousemove",l),e(n).unbind("touchend mouseup",d),t.preventDefault())},s.append(u),s.append(p.hide()),u.bind("touchstart mousedown",function(o){"touchstart"===o.type&&(o=t.event),f=o.pageX,h=o.pageY,g=s.width(),m=s.height(),b=!0,s.addClass("resizing"),p.show(),e(n).bind("touchmove mousemove",l),e(n).bind("touchend mouseup",d),7>e.sceditor.ie&&s.height(m),o.preventDefault()})},P=function(){var t,o=r.emoticons,i=r.emoticonsRoot;e.isPlainObject(o)&&r.emoticonsEnabled&&e.each(o,function(r,s){e.each(s,function(e,s){i&&(s={url:i+(s.url||s),tooltip:s.tooltip||e},o[r][e]=s),t=n.createElement("img"),t.src=s.url||s,ot.push(t)})})},G=function(){var t,n,o,i=W(),a=i.body,c=!!r.autofocusEnd;s.is(":visible")&&(Z.sourceMode()?(o=u.value.length,u.setSelectionRange?u.setSelectionRange(o,o):u.createTextRange&&(t=u.createTextRange(),t.moveEnd("character",o),t.moveStart("character",o),g.selectRange(t))):(c?e(a).append(n=i.createElement("div")):n=a.firstChild,i.createRange?(t=i.createRange(),t.setStart(n,0),t.setEnd(n,0)):(t=a.createTextRange(),t.moveToElementText(n),t.collapse(!1)),g.selectRange(t),c&&(e(i).scrollTop(a.scrollHeight),e(a).scrollTop(a.scrollHeight))),Z.focus())},Z.readOnly=function(e){return"boolean"!=typeof e?"readonly"===d.attr("readonly"):(W().body.contentEditable=!e,e?d.attr("readonly","readonly"):d.removeAttr("readonly"),$(e),this)},Z.rtl=function(t){var n=t?"rtl":"ltr";return"boolean"!=typeof t?"rtl"===d.attr("dir"):(e(W().body).attr("dir",n),d.attr("dir",n),s.removeClass("rtl").removeClass("ltr").addClass(n),this)},$=function(t){var n=Z.inSourceMode();a.find(".sceditor-button").removeClass("disabled").each(function(){var o=e(this);t===!0||n&&!o.data("sceditor-txtmode")?o.addClass("disabled"):n||o.data("sceditor-wysiwygmode")||o.addClass("disabled")})},Z.width=function(e,t){return e||0===e?(Z.dimensions(e,null,t),this):s.width()},Z.dimensions=function(e,t,n){return e=e||0===e?parseInt(e,10):!1,t=t||0===t?parseInt(t,10):!1,e===!1&&t===!1?{width:Z.width(),height:Z.height()}:(c.data("outerWidthOffset")===void 0&&Z.updateStyleCache(),e!==!1&&(n!==!1&&(r.width=e),e&&(""+e).indexOf("%")&&(e=s.width(e).width()),c.width(e-c.data("outerWidthOffset")),d.width(e-d.data("outerWidthOffset")),t===!1&&(t=s.height())),t!==!1&&(n!==!1&&(r.height=t),t&&(""+t).indexOf("%")&&(t=s.height(t).height(),s.height("auto")),t-=r.toolbarContainer?0:a.outerHeight(!0),c.height(t-c.data("outerHeightOffset")),d.height(t-d.data("outerHeightOffset"))),this)},Z.updateStyleCache=function(){c.data("outerWidthOffset",c.outerWidth(!0)-c.width()),d.data("outerWidthOffset",d.outerWidth(!0)-d.width()),c.data("outerHeightOffset",c.outerHeight(!0)-c.height()),d.data("outerHeightOffset",d.outerHeight(!0)-d.height())},Z.height=function(e,t){return e||0===e?(Z.dimensions(null,e,t),this):s.height()},Z.maximize=function(t){return t===void 0?s.is(".sceditor-maximize"):(t=!!t,7>e.sceditor.ie&&e("html, body").toggleClass("sceditor-maximize",t),s.toggleClass("sceditor-maximize",t),Z.width(t?"100%":r.width,!1),Z.height(t?"100%":r.height,!1),this)},Z.expandToContent=function(e){var t=W(),n=s.height(),o=t.body.scrollHeight||t.documentElement.scrollHeight,i=n-c.height(),a=r.resizeMaxHeight||2*(r.height||tt.height());o+=i,e!==!0&&o>a&&(o=a),o>n&&Z.height(o)},Z.destroy=function(){v.destroy(),g=null,f=null,v=null,e(n).unbind("click",q),e(t).unbind("resize orientationChanged",j),e(et.form).unbind("reset",F).unbind("submit",Z.updateOriginal),e(W().body).unbind(),e(W()).unbind().find("*").remove(),d.unbind().remove(),s.unbind().find("*").unbind().remove(),s.remove(),tt.removeData("sceditor").removeData("sceditorbbcode").show(),w&&tt.attr("required","required")},Z.createDropDown=function(t,n,o,i){var s=p&&p.is(".sceditor-"+n);if(Z.closeDropDown(),!s){i!==!1&&e(o).find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on");var a={top:t.offset().top,left:t.offset().left,marginTop:t.outerHeight()};e.extend(a,r.dropDownCss),p=e('<div class="sceditor-dropdown sceditor-'+n+'" />').css(a).append(o).appendTo(e("body")).click(function(e){e.stopPropagation()})}},q=function(e){3!==e.which&&Z.closeDropDown()},_=function(e){function t(e,n){if(e.childNodes.length>0){for(;e.firstChild;)n.appendChild(e.firstChild);for(;c.firstChild;)e.appendChild(c.firstChild);A(e,n)}else{if(s>25){for(;c.firstChild;)e.appendChild(c.firstChild);return g.restoreRange(),void 0}++s,setTimeout(function(){t(e,n)},20)}}var o,i=W().body,s=0,a=i.ownerDocument.createElement("div"),c=i.ownerDocument.createDocumentFragment();if(r.disablePasting)return!1;if(r.enablePasteFiltering){if(g.saveRange(),n.body.appendChild(a),e&&e.clipboardData&&e.clipboardData.getData&&((o=e.clipboardData.getData("text/html"))||(o=e.clipboardData.getData("text/plain"))))return a.innerHTML=o,A(i,a),e.stopPropagation(),e.preventDefault(),!1;for(;i.firstChild;)c.appendChild(i.firstChild);return t(i,a),Z.focus(),!0}},A=function(t,n){e.sceditor.dom.fixNesting(n);var o=n.innerHTML;v.hasHandler("toSource")&&(o=v.callOnlyFirst("toSource",o,e(n))),n.parentNode.removeChild(n),v.hasHandler("toWysiwyg")&&(o=v.callOnlyFirst("toWysiwyg",o,!0)),g.restoreRange(),g.insertHTML(S(o))},Z.closeDropDown=function(e){p&&(p.unbind().remove(),p=null),e===!0&&Z.focus()},W=function(){return l.contentDocument?l.contentDocument:l.contentWindow&&l.contentWindow.document?l.contentWindow.document:l.document?l.document:null},Z.wysiwygEditorInsertHtml=function(t,n,o){Z.focus(),(o||!e(g.parentNode()).is("code")&&0===e(g.parentNode()).parents("code").length)&&(g.insertHTML(t,n),X())},Z.wysiwygEditorInsertText=function(t,n){Z.wysiwygEditorInsertHtml(e.sceditor.escapeEntities(t),e.sceditor.escapeEntities(n))},Z.insertText=function(e,t){return Z.inSourceMode()?Z.sourceEditorInsertText(e,t):Z.wysiwygEditorInsertText(e,t),this},Z.sourceEditorInsertText=function(e,t){var o,i,r,s,a;a=u.scrollTop,u.focus(),u.selectionStart!==void 0?(i=u.selectionStart,r=u.selectionEnd,s=e.length,t&&(e+=u.value.substring(i,r)+t),u.value=u.value.substring(0,i)+e+u.value.substring(r,u.value.length),u.selectionStart=i+e.length-(t?t.length:0),u.selectionEnd=u.selectionStart):n.selection.createRange!==void 0?(o=n.selection.createRange(),t&&(e+=o.text+t),o.text=e,t&&o.moveEnd("character",0-t.length),o.moveStart("character",o.End-o.Start),o.select()):u.value+=e+t,u.scrollTop=a,u.focus()},Z.getRangeHelper=function(){return g},Z.val=function(e,t){return"string"==typeof e?(Z.inSourceMode()?Z.setSourceEditorValue(e):(t!==!1&&v.hasHandler("toWysiwyg")&&(e=v.callOnlyFirst("toWysiwyg",e)),Z.setWysiwygEditorValue(e)),this):Z.inSourceMode()?Z.getSourceEditorValue(!1):Z.getWysiwygEditorValue()},Z.insert=function(t,n,o,i,r){if(Z.inSourceMode())Z.sourceEditorInsertText(t,n);else{if(n){var s=Z.getRangeHelper().selectedHtml(),a=e("<div>").appendTo(e("body")).hide().html(s);o!==!1&&v.hasHandler("toSource")&&(s=v.callOnlyFirst("toSource",s,a)),a.remove(),t+=s+n}o!==!1&&v.hasHandler("toWysiwyg")&&(t=v.callOnlyFirst("toWysiwyg",t,!0)),o!==!1&&r===!0&&(t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),i!==!1&&(t=S(t)),Z.wysiwygEditorInsertHtml(t)}return this},Z.getWysiwygEditorValue=function(t){var n,o=c.contents().find("body");return e.sceditor.ie&&Z.focus(),g.saveRange(),e.sceditor.dom.fixNesting(o.get(0)),n=o.html(),t!==!1&&v.hasHandler("toSource")&&(n=v.callOnlyFirst("toSource",n,o)),g.restoreRange(),f=null,n},Z.getSourceEditorValue=function(e){var t=d.val();return e!==!1&&v.hasHandler("toWysiwyg")&&(t=v.callOnlyFirst("toWysiwyg",t)),t},Z.setWysiwygEditorValue=function(t){t||(t="<p>"+(e.sceditor.ie?"":"<br />")+"</p>"),W().body.innerHTML=S(t),X()},Z.setSourceEditorValue=function(e){d.val(e)},Z.updateOriginal=function(){tt.val(Z.val())},S=function(t){if(!r.emoticonsEnabled)return t;var n=e.extend({},r.emoticons.more,r.emoticons.dropdown,r.emoticons.hidden);return e.each(n,function(n,o){var s=e.sceditor.regexEscape(n)+"(?=([^\\<\\>]*?<(?!/code)|[^\\<\\>]*?$))",a="";r.emoticonsCompat&&(s="((>|^|\\s| | | | |&nbsp;))"+s+"(?=(\\s|$|<| | | | |&nbsp;))",a="$1"),t=t.replace(RegExp(s,"gm"),a+i("emoticon",{key:n,url:o.url||o,tooltip:o.tooltip||n}))}),t},Z.inSourceMode=function(){return s.hasClass("sourceMode")},Z.sourceMode=function(e){return"boolean"!=typeof e?Z.inSourceMode():((Z.inSourceMode()&&!e||!Z.inSourceMode()&&e)&&Z.toggleSourceMode(),this)},Z.toggleSourceMode=function(){(e.sceditor.isWysiwygSupported||!Z.inSourceMode())&&(Z.inSourceMode()?Z.setWysiwygEditorValue(Z.getSourceEditorValue()):Z.setSourceEditorValue(Z.getWysiwygEditorValue()),f=null,d.toggle(),c.toggle(),Z.inSourceMode()?s.removeClass("sourceMode").addClass("wysiwygMode"):s.removeClass("wysiwygMode").addClass("sourceMode"),$(),U())},Y=function(){return u.focus(),null!=u.selectionStart?u.value.substring(u.selectionStart,u.selectionEnd):n.selection.createRange?n.selection.createRange().text:void 0},E=function(t,n){return Z.inSourceMode()?(n.txtExec&&(e.isArray(n.txtExec)?Z.sourceEditorInsertText.apply(Z,n.txtExec):n.txtExec.call(Z,t,Y())),void 0):(n.exec&&(e.isFunction(n.exec)?n.exec.call(Z,t):Z.execCommand(n.exec,n.hasOwnProperty("execParam")?n.execParam:null)),void 0)},D=function(){e.sceditor.ie&&(f=g.selectedRange())},Z.execCommand=function(t,n){var o=!1,i=e(g.parentNode());if(Z.focus(),!i.is("code")&&0===i.parents("code").length){if(W())try{o=W().execCommand(t,!1,n)}catch(r){}!o&&Z.commands[t]&&Z.commands[t].errorMessage&&alert(Z._(Z.commands[t].errorMessage))}},Q=function(){x||(x=!0,setTimeout(function(){g&&!g.compare(b)&&(b=g.cloneSelected(),s.trigger(e.Event("selectionchanged"))),x=!1},100))},K=function(){var t=g.parentNode();y!==t&&(s.trigger(e.Event("nodechanged",{oldNode:y,newNode:t})),y=t)},Z.currentNode=function(){return y},U=function(e){var t,n,o,i,r,s=W(),c=rt.length,l=Z.sourceMode();if(Z.sourceMode()||Z.readOnly())a.find(".sceditor-button").removeClass("active");else for(r=e?e.newNode:g.parentNode(),o=g.getFirstBlockParent(r);c--;)if(t=0,n=rt[c],i=a.find(".sceditor-button-"+n.name),l&&!i.data("sceditor-txtmode"))i.addClass("disabled");else if(l||i.data("sceditor-wysiwygmode")){if("string"==typeof n.state)try{t=s.queryCommandEnabled(n.state)?0:-1,t>-1&&(t=s.queryCommandState(n.state)?1:0)}catch(d){}else t=n.state.call(Z,r,o);0>t?i.addClass("disabled"):i.removeClass("disabled"),t>0?i.addClass("active"):i.removeClass("active")}else i.addClass("disabled")},L=function(t){var n,o=nt.length;if(Z.closeDropDown(),n=e(g.parentNode()),13===t.which&&(n.is("code,blockquote,pre")||0!==n.parents("code,blockquote,pre").length))return f=null,Z.wysiwygEditorInsertHtml("<br />",null,!0),!1;if(!n.is("code")&&0===n.parents("code").length)for(;o--;)nt[o].call(Z,t,l,d)},X=function(){var t,n,o=W();e.sceditor.dom.rTraverse(o.body,function(i){return t=i.nodeName.toLowerCase(),e.inArray(t,it)>-1&&(n=!0),3===i.nodeType&&!/^\s*$/.test(i.nodeValue)||"br"===i.nodeName.toLowerCase()||e.sceditor.ie&&!i.firstChild&&!e.sceditor.dom.isInline(i,!1)?(n&&e(o.body).append(e("<div>"+(e.sceditor.ie?"":"<br />")+"</div>\n")),!1):void 0})},F=function(){Z.val(tt.val())},B=function(){Z.closeDropDown(),f=null},j=function(){var e=r.height,t=r.width;Z.maximize()?Z.height("100%",!1).width("100%",!1):(e&&(""+e).indexOf("%")>-1&&Z.height(e),t&&(""+t).indexOf("%")>-1&&Z.width(t))},Z._=function(){var e=arguments;return h&&h[e[0]]&&(e[0]=h[e[0]]),e[0].replace(/\{(\d+)\}/g,function(t,n){return e[n-0+1]!==void 0?e[n-0+1]:"{"+n+"}"})},V=function(t){var n,o=e.extend({},t);v.call(o.type+"Event",t,Z),delete o.type,n=e.Event((t.target===u?"scesrc":"scewys")+t.type,o),s.trigger.apply(s,[n,Z]),n.isDefaultPrevented()&&t.preventDefault(),n.isImmediatePropagationStopped()&&n.stopImmediatePropagation(),n.isPropagationStopped()&&n.stopPropagation()},Z.bind=function(t,n,o,i){var r=t.length;for(t=t.split(" ");r--;)e.isFunction(n)&&(o||s.bind("scewys"+t[r],n),i||s.bind("scesrc"+t[r],n));return this},Z.unbind=function(t,n,o,i){var r=t.length;for(t=t.split(" ");r--;)e.isFunction(n)&&(o||s.unbind("scewys"+t[r],n),i||s.unbind("scesrc"+t[r],n));return this},Z.blur=function(t,n,o){return e.isFunction(t)?Z.bind("blur",t,n,o):Z.sourceMode()?d.blur():(m||(m=e('<input style="width:0;height:0;opacity:0;border:0;padding:0;filter:alpha(opacity=0)" type="text" />').appendTo(s)),m.removeAttr("disabled").show().focus().blur().hide().attr("disabled","disabled")),this},Z.focus=function(t,n,o){return e.isFunction(t)?Z.bind("focus",t,n,o):Z.inSourceMode()?u.focus():(l.contentWindow.focus(),W().body.focus(),f&&(g.selectRange(f),f=null)),this},Z.keyDown=function(e,t,n){return Z.bind("keydown",e,t,n)},Z.keyPress=function(e,t,n){return Z.bind("keypress",e,t,n)},Z.keyUp=function(e,t,n){return Z.bind("keyup",e,t,n)},Z.nodeChanged=function(e){return Z.bind("nodechanged",e,!1,!0)},Z.selectionChanged=function(e){return Z.bind("selectionchanged",e,!1,!0)},J=function(t){var n=0,o=String.fromCharCode(t.which);return Z.emoticonsCache||(Z.emoticonsCache=[],e.each(e.extend({},r.emoticons.more,r.emoticons.dropdown,r.emoticons.hidden),function(e,t){Z.emoticonsCache[n++]=[e,i("emoticon",{key:e,url:t.url||t,tooltip:t.tooltip||e})]}),Z.emoticonsCache.sort(function(e,t){return e[0].length-t[0].length})),Z.longestEmoticonCode||(Z.longestEmoticonCode=Z.emoticonsCache[Z.emoticonsCache.length-1][0].length),Z.getRangeHelper().raplaceKeyword(Z.emoticonsCache,!0,!0,Z.longestEmoticonCode,r.emoticonsCompat,o)?/^\s$/.test(o)&&r.emoticonsCompat?!0:(t.preventDefault(),t.stopPropagation(),!1):void 0},Z.emoticons=function(t){if(!t&&t!==!1)return r.emoticonsEnabled;var n=e(W().body);return r.emoticonsEnabled=t,t?(n.keypress(J),Z.sourceMode()||(g.saveRange(),n.html(S(n.html())),g.restoreRange())):(n.find("img[data-sceditor-emoticon]").replaceWith(function(){return e(this).data("sceditor-emoticon")}),n.unbind("keypress",J)),this},Z.css=function(t){return C||(C=e('<style id="#inline" />').appendTo(e(W()).find("head"))[0]),"string"!=typeof t?C.styleSheet?C.styleSheet.cssText:C.innerHTML:(C.styleSheet?C.styleSheet.cssText=t:C.innerHTML=t,this)},k()},e.sceditor.ie=function(){var e,o=3,i=n.createElement("div"),r=i.getElementsByTagName("i");do i.innerHTML="<!--[if gt IE "+ ++o+"]><i></i><![endif]-->";while(r[0]);return n.all&&t.atob&&(o=10),o>4?o:e}(),e.sceditor.isWysiwygSupported=function(){var t,n=e('<div contenteditable="true">')[0].contentEditable,o=n!==void 0&&"inherit"!==n,i=navigator.userAgent;if(!o)return!1;var r=/Opera Mobi|Opera Mini/i.test(i);return/Android/i.test(i)&&(r=!0,/Safari/.test(i)&&(t=/Safari\/(\d+)/.exec(i),r=t&&t[1]?534>t[1]:!0)),/ Silk\//i.test(i)&&(t=/AppleWebKit\/(\d+)/.exec(i),r=t&&t[1]?534>t[1]:!0),/iPhone|iPod|iPad/i.test(i)&&(r=!/OS [5-9](_\d)+ like Mac OS X/i.test(i)),/fennec/i.test(i)&&(r=!1),!r}(),e.sceditor.regexEscape=function(e){return e.replace(/[\$\?\[\]\.\*\(\)\|\\]/g,"\\$&").replace("<","&lt;").replace(">","&gt;")},e.sceditor.escapeEntities=function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ {2}/g," &nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />"):e},e.sceditor.locale={},e.sceditor.commands={bold:{exec:"bold",tooltip:"Bold"},italic:{exec:"italic",tooltip:"Italic"},underline:{exec:"underline",tooltip:"Underline"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(t,n,o){for(var r=t.opts.fonts.split(","),s=e("<div />"),a=function(){return o(e(this).data("font")),t.closeDropDown(!0),!1},c=0;r.length>c;c++)s.append(i("fontOpt",{font:r[c]},!0).click(a));t.createDropDown(n,"font-picker",s)},exec:function(t){var n=this;e.sceditor.command.get("font")._dropDown(n,t,function(e){n.execCommand("fontname",e)})},tooltip:"Font Name"},size:{_dropDown:function(t,n,o){for(var r=e("<div />"),s=function(n){o(e(this).data("size")),t.closeDropDown(!0),n.preventDefault()},a=1;7>=a;a++)r.append(i("sizeOpt",{size:a},!0).click(s));t.createDropDown(n,"fontsize-picker",r)},exec:function(t){var n=this;e.sceditor.command.get("size")._dropDown(n,t,function(e){n.execCommand("fontsize",e)})},tooltip:"Font Size"},color:{_dropDown:function(t,n,o){var i,r,s,a,c={r:255,g:255,b:255},l=e("<div />"),d=t.opts.colors?t.opts.colors.split("|"):Array(21),u=[],p=e.sceditor.command.get("color");if(!p._htmlCache){for(i=0;d.length>i;++i){for(a=d[i]?d[i].split(","):Array(21),u.push('<div class="sceditor-color-column">'),r=0;a.length>r;++r)s=a[r]||"#"+c.r.toString(16)+c.g.toString(16)+c.b.toString(16),u.push('<a href="#" class="sceditor-color-option" style="background-color: '+s+'" data-color="'+s+'"></a>'),0===r%5?(c.g-=51,c.b=255):c.b-=51;u.push("</div>"),0===i%5?(c.r-=51,c.g=255,c.b=255):(c.g=255,c.b=255)}p._htmlCache=u.join("")}l.append(p._htmlCache).find("a").click(function(n){o(e(this).attr("data-color")),t.closeDropDown(!0),n.preventDefault()}),t.createDropDown(n,"color-picker",l)},exec:function(t){var n=this;e.sceditor.command.get("color")._dropDown(n,t,function(e){n.execCommand("forecolor",e)})},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(e){var t,n=this,o=i("pastetext",{label:n._("Paste your text inside the following box:"),insert:n._("Insert")},!0);o.find(".button").click(function(e){t=o.find("#txt").val(),t&&n.wysiwygEditorInsertText(t),n.closeDropDown(!0),e.preventDefault()}),n.createDropDown(e,"pastetext",o)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},table:{exec:function(t){var n=this,o=i("table",{rows:n._("Rows:"),cols:n._("Cols:"),insert:n._("Insert")},!0);o.find(".button").click(function(t){var i=o.find("#rows").val()-0,r=o.find("#cols").val()-0,s="<table>";if(!(1>i||1>r)){for(var a=0;i>a;a++){s+="<tr>";for(var c=0;r>c;c++)s+="<td>"+(e.sceditor.ie?"":"<br />")+"</td>";s+="</tr>"}s+="</table>",n.wysiwygEditorInsertHtml(s),n.closeDropDown(!0),t.preventDefault()}}),n.createDropDown(t,"inserttable",o)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{forceNewLineAfter:["code"],exec:function(){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{exec:function(e){var t=this,n=i("image",{url:t._("URL:"),width:t._("Width (optional):"),height:t._("Height (optional):"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#image").val(),i=n.find("#width").val(),r=n.find("#height").val(),s="";i&&(s+=' width="'+i+'"'),r&&(s+=' height="'+r+'"'),o&&"http://"!==o&&t.wysiwygEditorInsertHtml("<img"+s+' src="'+o+'" />'),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertimage",n)},tooltip:"Insert an image"},email:{exec:function(e){var t=this,n=i("email",{label:t._("E-mail:"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#email").val();o&&(t.focus(),t.getRangeHelper().selectedHtml()?t.execCommand("createlink","mailto:"+o):t.wysiwygEditorInsertHtml('<a href="mailto:'+o+'">'+o+"</a>")),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertemail",n)},tooltip:"Insert an email"},link:{exec:function(e){var t=this,n=i("link",{url:t._("URL:"),desc:t._("Description (optional):"),ins:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#link").val(),i=n.find("#des").val();o&&"http://"!==o&&(t.focus(),!t.getRangeHelper().selectedHtml()||i?(i||(i=o),t.wysiwygEditorInsertHtml('<a href="'+o+'">'+i+"</a>")):t.execCommand("createlink",o)),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertlink",n)},tooltip:"Insert a link"},unlink:{exec:"unlink",tooltip:"Unlink"},quote:{forceNewLineAfter:["blockquote"],exec:function(e,t,n){var o="<blockquote>",i="</blockquote>";t?(n=n?"<cite>"+n+"</cite>":"",o=o+n+t+i+"<br />",i=null):""===this.getRangeHelper().selectedHtml()&&(i="<br />"+i),this.wysiwygEditorInsertHtml(o,i)},tooltip:"Insert a Quote"},emoticon:{exec:function(t){var n=this,o=function(i){var r=n.opts.emoticonsCompat?" ":"",s=e("<div />"),a=e("<div />").appendTo(s),c=e.extend({},n.opts.emoticons.dropdown,i?n.opts.emoticons.more:{}),l=0;for(var d in c)c.hasOwnProperty(d)&&l++;return l=Math.sqrt(l),e.each(c,function(t,o){a.append(e("<img />").attr({src:o.url||o,alt:t,title:o.tooltip||t}).click(function(){return n.insert(e(this).attr("alt")+r).closeDropDown(!0),!1})),a.children().length>=l&&(a=e("<div />").appendTo(s))}),i||s.append(e(n._('<a class="sceditor-more">{0}</a>',n._("More"))).click(function(){return n.createDropDown(t,"more-emoticons",o(!0)),!1})),s};n.createDropDown(t,"emoticons",o(!1))},txtExec:function(t){e.sceditor.command.get("emoticon").exec.call(this,t)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(e,t,n){var o,r=i("youtubeMenu",{label:e._("Video URL:"),insert:e._("Insert")},!0);r.find(".button").click(function(t){var i=r.find("#link").val().replace("http://","");""!==i&&(o=i.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/),o&&(i=o[1]),/^[a-zA-Z0-9_\-]{11}$/.test(i)?n(i):alert("Invalid YouTube video")),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"insertlink",r)},exec:function(t){var n=this;e.sceditor.command.get("youtube")._dropDown(n,t,function(e){n.wysiwygEditorInsertHtml(i("youtube",{id:e}))})},tooltip:"Insert a YouTube video"},date:{_date:function(e){var t=new Date,n=t.getYear(),o=t.getMonth()+1,i=t.getDate();return 2e3>n&&(n=1900+n),10>o&&(o="0"+o),10>i&&(i="0"+i),e.opts.dateFormat.replace(/year/i,n).replace(/month/i,o).replace(/day/i,i)},exec:function(){this.insertText(e.sceditor.command.get("date")._date(this))},txtExec:function(){this.insertText(e.sceditor.command.get("date")._date(this))},tooltip:"Insert current date"},time:{_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return 10>t&&(t="0"+t),10>n&&(n="0"+n),10>o&&(o="0"+o),t+":"+n+":"+o},exec:function(){this.insertText(e.sceditor.command.get("time")._time())},txtExec:function(){this.insertText(e.sceditor.command.get("time")._time())},tooltip:"Insert current time"},ltr:{state:function(e,t){return t&&"ltr"===t.style.direction},exec:function(){var t=this,n=t.getRangeHelper().getFirstBlockParent(),o=e(n);t.focus(),(n&&!o.is("body")||(t.execCommand("formatBlock","p"),n=t.getRangeHelper().getFirstBlockParent(),o=e(n),n&&!o.is("body")))&&("ltr"===o.css("direction")?o.css("direction",""):o.css("direction","ltr"))},tooltip:"Left-to-Right"},rtl:{state:function(e,t){return t&&"rtl"===t.style.direction},exec:function(){var t=this,n=t.getRangeHelper().getFirstBlockParent(),o=e(n);t.focus(),(n&&!o.is("body")||(t.execCommand("formatBlock","p"),n=t.getRangeHelper().getFirstBlockParent(),o=e(n),n&&!o.is("body")))&&("rtl"===o.css("direction")?o.css("direction",""):o.css("direction","rtl"))},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize())},txtExec:function(){this.maximize(!this.maximize())},tooltip:"Maximize"},source:{exec:function(){this.toggleSourceMode(),this.blur()},txtExec:function(){this.toggleSourceMode(),this.blur()},tooltip:"View source"},ignore:{}},e.sceditor.rangeHelper=function(t,n){var o,i,r,s,a,c,l=!0,d="sceditor-start-marker",u="sceditor-end-marker",p="character",f=this;r=function(e,t){i=t||e.contentDocument||e.document,o=e,l=!!e.getSelection}(t,n),f.insertHTML=function(e,t){var n,o,r=f.selectedRange();if(t&&(e+=f.selectedHtml()+t),l){for(o=i.createElement("div"),n=i.createDocumentFragment(),o.innerHTML=e;o.firstChild;)n.appendChild(o.firstChild);f.insertNode(n)}else{if(!r)return!1;r.pasteHTML(e)}},f.insertNode=function(e,t){if(l){var n,o,r=i.createDocumentFragment(),s=f.selectedRange();if(!s)return!1;if(r.appendChild(e),t&&(r.appendChild(s.extractContents()),r.appendChild(t)),o=r.lastChild,!o)return;s.deleteContents(),s.insertNode(r),n=i.createRange(),n.setStartAfter(o),f.selectRange(n)}else f.insertHTML(e.outerHTML,t?t.outerHTML:null)},f.cloneSelected=function(){var e=f.selectedRange();return e?l?e.cloneRange():e.duplicate():void 0},f.selectedRange=function(){var e,t,n=l?o.getSelection():i.selection;if(n&&(n.getRangeAt&&0>=n.rangeCount&&(e=i.createRange(),e.setStart(i.body,0),n.addRange(e)),e=l?n.getRangeAt(0):n.createRange(),!e.parentElement||!(t=e.parentElement())||t.ownerDocument===i))return e},f.selectedHtml=function(){var e,t=f.selectedRange();return t?!l&&""!==t.text&&t.htmlText?t.htmlText:l?(e=i.createElement("div"),e.appendChild(t.cloneContents()),e.innerHTML):"":""
},f.parentNode=function(){var e=f.selectedRange();if(e){if(l)return e.commonAncestorContainer;if(e.parentElement)return e.parentElement()}},f.getFirstBlockParent=function(t){var n=function(t){if(!e.sceditor.dom.isInline(t))return t;var o=t?t.parentNode:null;return o?n(o):null};return n(t||f.parentNode())},f.insertNodeAt=function(e,t){var n=f.selectedRange(),o=f.cloneSelected();return o?(o.collapse(e),o.insertNode?o.insertNode(t):o.pasteHTML(t.outerHTML),f.selectRange(n),void 0):!1},s=function(e){f.removeMarker(e);var t=i.createElement("span");return t.id=e,t.style.lineHeight="0",t.style.display="none",t.className="sceditor-selection sceditor-ignore",t},f.insertMarkers=function(){f.insertNodeAt(!0,s(d)),f.insertNodeAt(!1,s(u))},f.getMarker=function(e){return i.getElementById(e)},f.removeMarker=function(e){var t=f.getMarker(e);t&&t.parentNode.removeChild(t)},f.removeMarkers=function(){f.removeMarker(d),f.removeMarker(u)},f.saveRange=function(){f.insertMarkers()},f.selectRange=function(e){l?(o.getSelection().removeAllRanges(),o.getSelection().addRange(e)):e.select()},f.restoreRange=function(){var e,t=f.selectedRange(),n=f.getMarker(d),o=f.getMarker(u);return n&&o&&t?(l?(t=i.createRange(),t.setStartBefore(n),t.setEndAfter(o),f.selectRange(t)):(t=i.body.createTextRange(),e=i.body.createTextRange(),e.moveToElementText(n),t.setEndPoint("StartToStart",e),t.moveStart(p,0),e.moveToElementText(o),t.setEndPoint("EndToStart",e),t.moveEnd(p,0),f.selectRange(t)),f.removeMarkers(),void 0):!1},c=function(e,t){var n=f.cloneSelected();return n?(n.collapse(!1),l?(n.setStart(n.startContainer,n.startOffset-e),n.setEnd(n.endContainer,n.endOffset+t)):(n.moveStart(p,0-e),n.moveEnd(p,t)),f.selectRange(n),void 0):!1},a=function(e,t){var n="",o=f.cloneSelected();return o?(o.collapse(!1),e?l?(n=o.startContainer.textContent.substr(0,o.startOffset),n=n.substr(Math.max(0,n.length-t))):(o.moveStart(p,0-t),n=o.text):l?n=o.startContainer.textContent.substr(o.startOffset,t):(o.moveEnd(p,t),n=o.text),n):""},f.raplaceKeyword=function(t,n,o,i,r,s){o||t.sort(function(e,t){return e.length-t.length});var d,u,p,h,g,m,v,y,b=i||t[t.length-1][0].length;if(d=u=p="",r){if(!l)return!1;++b}for(d=a(!0,b),n&&(u=a(!1,b)),p=d+(null!=s?s:"")+u,h=t.length;h--;)if(v=RegExp("(?:[\\s    ])"+e.sceditor.regexEscape(t[h][0])+"(?=[\\s    ])"),y=d.length-1-t[h][0].length,r&&--y,y=Math.max(0,y),!r&&(g=p.indexOf(t[h][0],y))>-1||r&&(g=p.substr(y).search(v))>-1){if(r&&(g+=y+1),g>d.length||g+t[h][0].length+(r?1:0)<d.length)continue;return m=d.length-g,c(m,t[h][0].length-m-(null!=s&&/^\S/.test(s)?1:0)),f.insertHTML(t[h][1]),!0}return!1},f.compare=function(e,t){return t||(t=f.selectedRange()),e&&t?l?0===e.compareBoundaryPoints(Range.END_TO_END,t)&&0===e.compareBoundaryPoints(Range.START_TO_START,t):0===e.compareEndPoints("EndToEnd",t)&&0===e.compareEndPoints("StartToStart",t):!e&&!t}},e.sceditor.dom={traverse:function(e,t,n,o,i){if(e)for(e=i?e.lastChild:e.firstChild;null!=e;){var r=i?e.previousSibling:e.nextSibling;if(!n&&t(e)===!1)return!1;if(!o&&this.traverse(e,t,n,o,i)===!1)return!1;if(n&&t(e)===!1)return!1;e=r}},rTraverse:function(e,t,n,o){this.traverse(e,t,n,o,!0)},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|",isInline:function(t,n){return t&&1===t.nodeType?(t=t.tagName.toLowerCase(),"code"===t?!n:0>e.sceditor.dom.blockLevelList.indexOf("|"+t+"|")):!0},copyCSS:function(e,t){t.style.cssText=e.style.cssText+t.style.cssText},fixNesting:function(e){var t=this,n=function(e){for(;t.isInline(e.parentNode,!0);)e=e.parentNode;return e};t.traverse(e,function(e){if(1===e.nodeType&&!t.isInline(e,!0)&&t.isInline(e.parentNode,!0)){var o=n(e),i=o.parentNode,r=t.extractContents(o,e),s=e;t.copyCSS(o,s),i.insertBefore(r,o),i.insertBefore(s,o)}})},findCommonAncestor:function(t,n){return e(t).parents().has(e(n)).first()},getSibling:function(t,n){var o;return t?(o=t[n?"previousSibling":"nextSibling"])?o:e.sceditor.dom.getSibling(t.parentNode,n):null},removeWhiteSpace:function(t,n){for(var o,i,r,s,a,c,l,d,u=e.sceditor.dom.getSibling,p=e.sceditor.dom.isInline,f=t.firstChild,h=/[\t ]+/g,g=/[\t\n\r ]+/g;f;){if(c=f.nextSibling,o=f.nodeValue,i=f.nodeType,1===i&&f.firstChild&&(a=e(f).css("white-space"),/pre(?:\-wrap)?$/i.test(a)||e.sceditor.dom.removeWhiteSpace(f,/line$/i.test(a))),3===i&&o){if(r=u(f),s=u(f,!0),d=f,l=!1,p(f))for(;d=u(d,!0);){for(;d.lastChild;)d=d.lastChild;if(!p(d)||3===d.nodeType){l=3===d.nodeType?/[\t\n\r ]$/.test(d.nodeValue):!0;break}}p(f)&&s&&p(s)&&!l||(o=o.replace(/^[\t\n\r ]+/,"")),p(f)&&r&&p(r)||(o=o.replace(/[\t\n\r ]+$/,"")),o.length?f.nodeValue=o.replace(n?h:g," "):t.removeChild(f)}f=c}},extractContents:function(e,t){var n=this,o=n.findCommonAncestor(e,t),i=o?o[0]:null,r=!1,s=!1;return function a(o){var i=e.ownerDocument.createDocumentFragment();return n.traverse(o,function(n){if(s||n===t&&r)return s=!0,!1;n===e&&(r=!0);var o,c;r?jQuery.contains(n,t)&&1===n.nodeType?(o=a(n),c=n.cloneNode(!1),c.appendChild(o),i.appendChild(c)):i.appendChild(n):jQuery.contains(n,e)&&1===n.nodeType&&(o=a(n),c=n.cloneNode(!1),c.appendChild(o),i.appendChild(c))},!1),i}(i)}},e.sceditor.plugins={},e.sceditor.PluginManager=function(t){var n=this,o=[],i=t,r=function(e){return"signal"+e.charAt(0).toUpperCase()+e.slice(1)},s=function(e,t){e=[].slice.call(e);for(var n=o.length,s=r(e.shift());n--;)if(s in o[n]){if(t)return o[n][s].apply(i,e);o[n][s].apply(i,e)}};n.call=function(){s(arguments,!1)},n.callOnlyFirst=function(){return s(arguments,!0)},n.iter=function(e){return e=r(e),function(){var t=o.length;return{callNext:function(n){for(;t--;)if(o[t]&&e in o[t])return o[t].apply(i,n)},hasNext:function(){for(var n=t;n--;)if(o[n]&&e in o[n])return!0;return!1}}}()},n.hasHandler=function(e){var t=o.length;for(e=r(e);t--;)if(e in o[t])return!0;return!1},n.exsists=function(t){return t in e.sceditor.plugins?(t=e.sceditor.plugins[t],"function"==typeof t&&"object"==typeof t.prototype):!1},n.isRegistered=function(t){var i=o.length;if(!n.exsists(t))return!1;for(;i--;)if(o[i]instanceof e.sceditor.plugins[t])return!0;return!1},n.register=function(t){return n.exsists(t)?(t=new e.sceditor.plugins[t],o.push(t),"init"in t&&t.init.apply(i),!0):!1},n.deregister=function(t){var r,s=o.length,a=!1;if(!n.isRegistered(t))return!1;for(;s--;)o[s]instanceof e.sceditor.plugins[t]&&(r=o.splice(s,1)[0],a=!0,"destroy"in r&&r.destroy.apply(i));return a},n.destroy=function(){for(var e=o.length;e--;)"destroy"in o[e]&&o[e].destroy.apply(i);o=null,i=null}},e.sceditor.command={get:function(t){return e.sceditor.commands[t]||null},set:function(t,n){return t&&n?(n=e.extend(e.sceditor.commands[t]||{},n),n.remove=function(){e.sceditor.command.remove(t)},e.sceditor.commands[t]=n,this):!1},remove:function(t){return e.sceditor.commands[t]&&delete e.sceditor.commands[t],this}},e.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,runWithoutWysiwygSupport:!1,id:null,plugins:"",zIndex:null,parserOptions:{},dropDownCss:{}},e.fn.sceditor=function(t){var n,o=[];return t=t||{},t.runWithoutWysiwygSupport||e.sceditor.isWysiwygSupported?(this.each(function(){n=this.jquery?this:e(this),n.parents(".sceditor-container").length>0||("state"===t?o.push(!!n.data("sceditor")):"instance"===t?o.push(n.data("sceditor")):n.data("sceditor")||new e.sceditor(this,t))}),o.length?1===o.length?o[0]:e(o):this):void 0}})(jQuery,window,document);