(function(d){d.sceditor=function(c,b){var a=this,e=d(c),f=null,h=null,g=null,i=null,k=null,j=null,n=!1,q=[],l=null,o=null,I=[],p,r,w,x,y,v,z,A,B,C,D,E,F,m,G,t,u,H,s;a.commands=d.sceditor.commands;A=function(){k=d("<textarea></textarea>").hide();g=d('<iframe frameborder="0"></iframe>');"https:"===window.location.protocol&&g.attr("src","javascript:false");f.append(g).append(k);i=g[0];u(e.width());t(e.height());m().designMode="On";m().open();m().write('<html><head><link rel="stylesheet" type="text/css" href="'+
a.options.style+'" /></head><body></body></html>');m().close();m().designMode="On";d(m()).find("body").keypress(v);d(m()).keypress(v);d(m()).mousedown(z);d(m()).bind("beforedeactivate keypress",y)};B=function(){var b=function(b){x(d(this),a.commands[d(this).data("sceditor-command")]);b.preventDefault()};h=d('<div class="sceditor-toolbar" />');for(var c=a.options.toolbar.split("|"),e=0;e<c.length;e++){for(var n=d('<div class="sceditor-group" />'),j=c[e].split(","),g=0;g<j.length;g++)if(a.commands.hasOwnProperty(j[g])){var i=
d('<a class="sceditor-button sceditor-button-'+j[g]+' " unselectable="on"><div unselectable="on" /></a>');a.commands[j[g]].hasOwnProperty("tooltip")&&i.attr("title",a._(a.commands[j[g]].tooltip));a.commands[j[g]].exec?i.data("sceditor-wysiwygmode",!0):i.addClass("disabled");a.commands[j[g]].txtExec&&i.data("sceditor-txtmode",!0);i.data("sceditor-command",j[g]);i.click(b);n.append(i)}h.append(n)}null===a.options.toolbarContainer?f.append(h):d(a.options.toolbarContainer).append(h)};C=function(){d.each(a.commands,
function(a,b){"undefined"!==typeof b.keyPress&&q.push(b.keyPress)})};u=function(a){f.width(a);g.width(a);g.width(a+(a-g.outerWidth(!0)));k.width(a);k.width(a+(a-k.outerWidth(!0)))};t=function(b){f.height(b);b-=null===a.options.toolbarContainer?h.outerHeight():0;g.height(b);g.height(b+(b-g.outerHeight(!0)));k.height(b);k.height(b+(b-k.outerHeight(!0)))};D=function(){var b=d('<div class="sceditor-grip" />'),c=d('<div class="sceditor-resize-cover" />'),e=0,j=0,g=0,n=0,h=f.width(),i=f.height(),l=!1,q,
k,r,p,o;q=null==a.options.resizeMinHeight?i/2:a.options.resizeMinHeight;k=null==a.options.resizeMaxHeight?2*i:a.options.resizeMaxHeight;r=null==a.options.resizeMinWidth?h/2:a.options.resizeMinWidth;p=null==a.options.resizeMaxWidth?2*h:a.options.resizeMaxWidth;o=function(a){var b=n+(a.pageY-j),d=g+(a.pageX-e);d>=r&&(0>p||d<=p)&&u(d);b>=q&&(0>k||b<=k)&&t(b);a.preventDefault()};f.append(b);f.append(c.hide());b.mousedown(function(a){e=a.pageX;j=a.pageY;g=f.width();n=f.height();l=!0;c.show();d(document).bind("mousemove",
o);a.preventDefault()});d(document).mouseup(function(a){l&&(l=!1,c.hide(),d(document).unbind("mousemove",o),a.preventDefault())})};F=function(){var b=d.extend({},a.options.emoticons.more,a.options.emoticons.dropdown,a.options.emoticons.hidden);d.each(b,function(a,b){var d=document.createElement("img");d.src=b;I.push(d)})};a.createDropDown=function(b,c,e,f){a.closeDropDown();!1!==f&&(e=d(e),e.find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"));j=d('<div class="sceditor-dropdown sceditor-'+
c+'" />').css({top:b.offset().top,left:b.offset().left}).append(e);j.appendTo(d("body"));n=!0;j.click(function(a){a.stopPropagation()})};E=function(b){!n&&3!==b.which&&a.closeDropDown();n=!1};a.closeDropDown=function(b){null!==j&&(j.remove(),j=null);!0===b&&a.focus()};m=function(){return i.contentDocument?i.contentDocument:i.contentWindow&&i.contentWindow.document?i.contentWindow.document:i.document?i.document:null};a.wysiwygEditorInsertHtml=function(b,c,e){a.focus();if(e||!(d(p()).is("code")||0!==
d(p()).parents("code").length)){"undefined"!==typeof c&&null!==c&&(b=b+a.getWysiwygSelectedHtml()+c);if(m().getSelection){c=r();e=m().createElement("div");e.innerHTML=b;e=e.children[0];c.deleteContents();c.insertNode(e);c=c.cloneRange();if(e.parentNode!==c.startContainer||!d.browser.opera)c.setStartAfter(e);else return;i.contentWindow.getSelection().removeAllRanges();i.contentWindow.getSelection().addRange(c)}else m().selection&&m().selection.createRange?m().selection.createRange().pasteHTML(b):a.execCommand("insertHtml",
b);l=null}};a.wysiwygEditorInsertText=function(b){b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />");a.wysiwygEditorInsertHtml("<span>"+b+"</span>")};r=function(){var a;i.contentWindow&&i.contentWindow.getSelection?a=i.contentWindow.getSelection():m().selection&&(a=m().selection);a.getRangeAt&&0>=a.rangeCount&&a.addRange(m().createRange());return a.getRangeAt?a.getRangeAt(0):a.createRange?a.createRange():null};
a.getWysiwygSelectedHtml=function(){var a=r();if(null===a)return"";if(document.selection&&document.selection.createRange){if(""===a.text)return"";if("undefined"!==typeof a.htmlText)return a.htmlText}if(window.XMLSerializer){var b="";d(a.cloneContents().childNodes).each(function(){b+=(new XMLSerializer).serializeToString(this)});return b}};p=function(){var a=r();if(null===a)return null;if(window.getSelection&&"undefined"!==typeof a.commonAncestorContainer)return a.commonAncestorContainer;if(document.selection&&
document.selection.createRange)return a.parentElement()};a.getWysiwygEditorValue=function(b){var c=g.contents().find("body");d.sceditor.dom.fixNesting(c.get(0));var e=c.html();!1!==b&&a.options.getHtmlHandler&&(e=a.options.getHtmlHandler(e,c));return e};a.getTextareaValue=function(b){var d=k.val();!1!==b&&a.options.getTextHandler&&(d=a.options.getTextHandler(d));return d};a.setWysiwygEditorValue=function(a){m().body.innerHTML=w(a)};a.setTextareaValue=function(a){k.val(a)};a.updateTextareaValue=function(){s()?
e.val(a.getTextareaValue(!1)):e.val(a.getWysiwygEditorValue())};w=function(b){var c=d.extend({},a.options.emoticons.more,a.options.emoticons.dropdown,a.options.emoticons.hidden);d.each(c,function(d,c){var e=a.regexEscape(d)+"(?=([^\\<\\>]*?<(?!/code)|[^\\<\\>]*?$))",f="";a.options.emoticonsCompat&&(e="((>|^|\\s){1})"+e+"(?=(\\s|$|<){1})",f="$1");b=b.replace(RegExp(e,"gm"),f+'<img src="'+c+'" data-sceditor-emoticon="'+d+'" />')});return b};a.regexEscape=function(a){return a.replace(/[\$\?\[\]\.\*\(\)\|]/g,
"\\$&").replace("<","&lt;").replace(">","&gt;")};s=function(){return k.is(":visible")};a.toggleTextMode=function(){s()?a.setWysiwygEditorValue(a.getTextareaValue()):a.setTextareaValue(a.getWysiwygEditorValue());h.find(".sceditor-button").removeClass("disabled");l=null;k.toggle();g.toggle();h.find(".sceditor-button").each(function(){var a=d(this);s()&&!a.data("sceditor-txtmode")?a.addClass("disabled"):!s()&&!a.data("sceditor-wysiwygmode")&&a.addClass("disabled")})};x=function(b,c){s()?c.hasOwnProperty("txtExec")&&
c.txtExec.call(a,b):c.hasOwnProperty("exec")&&(d.isFunction(c.exec)?c.exec.call(a,b):a.execCommand(c.exec,c.hasOwnProperty("execParam")?c.execParam:null))};a.focus=function(){i.contentWindow.focus();null!==l&&(window.document.createRange?window.getSelection().addRange(l):window.document.selection&&l.select(),l=null)};y=function(){d.browser.msie&&(l=r())};a.execCommand=function(b,c){var e=!1;a.focus();if(!(d(p()).is("code")||0!==d(p()).parents("code").length)){if(m())try{e=m().execCommand(b,!1,c)}catch(f){}!e&&
"undefined"!==typeof a.commands[b]&&"undefined"!==typeof a.commands[b].errorMessage&&alert(a._(a.commands[b].errorMessage))}};v=function(b){a.closeDropDown();var c=p(),c=d(c);if(13===b.which&&(c.is("code, blockquote")||0!==c.parents("code, blockquote").length))return a.wysiwygEditorInsertHtml("<br />",null,!0),!1;var e=m();d.sceditor.dom.rTraverse(e.body,function(a){if(3===a.nodeType&&""!==a.nodeValue||"br"===a.nodeName.toLowerCase())return 0<d(a).parents("code, blockquote").length&&d(e.body).append(e.createElement("br")),
!1},!0);if(!(c.is("code")||0!==c.parents("code").length))for(c=q.length;c--;)q[c].call(a,b,i,k)};z=function(){a.closeDropDown()};G=function(){null!==a.options.height&&-1<a.options.height.toString().indexOf("%")&&t(f.parent().height()*(parseFloat(a.options.height)/100));null!==a.options.width&&-1<a.options.width.toString().indexOf("%")&&u(f.parent().width()*(parseFloat(a.options.width)/100))};a._=function(){var a=arguments;null!==o&&o[a[0]]&&(a[0]=o[a[0]]);return a[0].replace(/\{(\d+)\}/g,function(b,
c){return"undefined"!==typeof a[c-0+1]?a[c-0+1]:"{"+c+"}"})};H=function(){if(d.sceditor.locale[a.options.locale])o=d.sceditor.locale[a.options.locale];else{var b=a.options.locale.split("-");d.sceditor.locale[b[0]]&&(o=d.sceditor.locale[b[0]])}null!==o&&o.dateFormat&&(a.options.dateFormat=o.dateFormat)};(function(){e.data("sceditor",a);a.options=d.extend({},d.sceditor.defaultOptions,b);null!==a.options.locale&&"en"!==a.options.locale&&H();null!==a.options.height&&e.height(a.options.height);null!==
a.options.width&&e.width(a.options.width);(null!==a.options.height&&-1<a.options.height.toString().indexOf("%")||null!==a.options.width&&-1<a.options.width.toString().indexOf("%"))&&d(window).resize(G);f=d('<div class="sceditor-container" />').width(e.outerWidth()).height(e.outerHeight());e.after(f);B();A();C();a.options.resizeEnabled&&D();e.parents("form").submit(a.updateTextareaValue);d(document).click(E);var c=e.hide().val();a.options.getTextHandler&&(c=a.options.getTextHandler(c));a.setWysiwygEditorValue(c);
F()})()};d.sceditor.locale={};d.sceditor.commands={bold:{exec:"bold",tooltip:"Bold"},italic:{exec:"italic",tooltip:"Italic"},underline:{exec:"underline",tooltip:"Underline"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",
tooltip:"Justify"},font:{exec:function(c){for(var b=this,a=b.options.fonts.split(","),e=d("<div />"),f=function(a){b.execCommand("fontname",d(this).data("sceditor-font"));b.closeDropDown(!0);a.preventDefault()},h=0;h<a.length;h++)e.append(d('<a class="sceditor-font-option" href="#"><font face="'+a[h]+'">'+a[h]+"</font></a>").data("sceditor-font",a[h]).click(f));b.createDropDown(c,"font-picker",e)},tooltip:"Font Name"},size:{exec:function(c){for(var b=this,a=d("<div />"),e=function(a){b.execCommand("fontsize",
d(this).data("sceditor-fontsize"));b.closeDropDown(!0);a.preventDefault()},f=1;7>=f;f++)a.append(d('<a class="sceditor-fontsize-option" href="#"><font size="'+f+'">'+f+"</font></a>").data("sceditor-fontsize",f).click(e));b.createDropDown(c,"fontsize-picker",a)},tooltip:"Font Size"},color:{exec:function(c){for(var b=this,a={r:255,g:255,b:255},e=d("<div />"),f=this.options.colors?this.options.colors.split("|"):Array(21),h=[],g=0,i=0;i<f.length;++i){var k="undefined"!==typeof f[i]?f[i].split(","):Array(21);
h[g++]='<div class="sceditor-color-column">';for(var j=0;j<k.length;++j){var n="undefined"!==typeof k[j]?k[j]:"#"+a.r.toString(16)+a.g.toString(16)+a.b.toString(16);h[g++]='<a href="#" class="sceditor-color-option" style="background-color: '+n+'" data-color="'+n+'"></a>';a=0===j%5?{r:a.r,g:a.g-51,b:255}:{r:a.r,g:a.g,b:a.b-51}}h[g++]="</div>";a=0===i%5?{r:a.r-51,g:255,b:255}:{r:a.r,g:255,b:255}}e.append(h.join("")).find("a").click(function(a){b.execCommand("forecolor",d(this).attr("data-color"));b.closeDropDown(!0);
a.preventDefault()});b.createDropDown(c,"color-picker",e)},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},
pastetext:{exec:function(c){var b=this,a=d(this._('<form><div><label for="txt">{0}</label> <textarea cols="20" rows="7" id="txt"></textarea></div></form>',this._("Paste your text inside the following box:"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){b.wysiwygEditorInsertText(d(this).parent("form").find("#txt").val());b.closeDropDown(!0);a.preventDefault()}));b.createDropDown(c,"pastetext",a)},
tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},undo:{exec:"undo",tooltip:"Undo"},redo:{exec:"redo",tooltip:"Redo"},table:{exec:function(c){var b=this,a=d(this._('<form><div><label for="rows">{0}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{1}</label><input type="text" id="cols" value="2" /></div></form>',this._("Rows:"),this._("Cols:"))).submit(function(){return!1});
a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){var c=d(this).parent("form").find("#rows").val()-0,h=d(this).parent("form").find("#cols").val()-0,g="<table>";if(!(1>c||1>h)){for(var i=0;i<c;i++){for(var g=g+"<tr>",k=0;k<h;k++)g=d.browser.msie?g+"<td></td>":g+'<td><br class="sceditor-ignore" /></td>';g+="</tr>"}b.wysiwygEditorInsertHtml(g+"</table>");b.closeDropDown(!0);a.preventDefault()}}));b.createDropDown(c,"inserttable",a)},
tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{exec:function(c){var b=this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="image" value="http://" /></div><div><label for="width">{1}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{2}</label> <input type="text" id="height" size="2" /></div></form>',
this._("URL:"),this._("Width (optional):"),this._("Height (optional):"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="Insert" /></div>',this._("Insert"))).click(function(a){var c=d(this).parent("form"),h=c.find("#image").val(),g="",i;if(i=c.find("#width").val())g+=' width="'+i+'"';if(c=c.find("#height").val())g+=' height="'+c+'"';h&&"http://"!==h&&b.wysiwygEditorInsertHtml("<img"+g+' src="'+h+'" />');b.closeDropDown(!0);a.preventDefault()}));b.createDropDown(c,
"insertimage",a)},tooltip:"Insert an image"},email:{exec:function(c){var b=this,a=d(this._('<form><div><label for="email">{0}</label> <input type="text" id="email" value="" /></div></form>',this._("E-mail:"))).submit(function(){return!1});a.append(d('<div><input type="button" class="button" value="Insert" /></div>').click(function(a){var c=d(this).parent("form").find("#email").val();c&&(b.focus(),b.getWysiwygSelectedHtml()?b.execCommand("createlink","mailto:"+c):b.wysiwygEditorInsertHtml('<a href="mailto:'+
c+'">'+c+"</a>"));b.closeDropDown(!0);a.preventDefault()}));b.createDropDown(c,"insertemail",a)},tooltip:"Insert an email"},link:{exec:function(c){var b=this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="link" value="http://" /></div><div><label for="des">{1}</label> <input type="text" id="des" value="" /></div></form>',this._("URL:"),this._("Description (optional):"))).submit(function(){return!1});a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',
this._("Insert"))).click(function(a){var c=d(this).parent("form").find("#link").val(),h=d(this).parent("form").find("#des").val();""!==c&&"http://"!==c&&(b.focus(),!b.getWysiwygSelectedHtml()||h?(h||(h=c),b.wysiwygEditorInsertHtml('<a href="'+c+'">'+h+"</a>")):b.execCommand("createlink",c));b.closeDropDown(!0);a.preventDefault()}));b.createDropDown(c,"insertlink",a)},tooltip:"Insert a link"},unlink:{exec:"unlink",tooltip:"Unlink"},quote:{exec:function(c,b){var a="<blockquote>",d="</blockquote>";b?
(a=a+b+d,d=null):d="<br />"+d;this.wysiwygEditorInsertHtml(a,d)},tooltip:"Insert a Quote"},emoticon:{exec:function(c){var b=this,a=d("<div />"),e=d("<div />"),f=function(c,f){e.append(d("<img />").attr({src:f,alt:c}).click(function(a){var c,e;b.options.emoticonsCompat&&(c="<span> ",e=" </span>");b.wysiwygEditorInsertHtml(c+'<img src="'+d(this).attr("src")+'" data-sceditor-emoticon="'+d(this).attr("alt")+'" />'+e);b.closeDropDown(!0);a.preventDefault()}));3<e.children().length&&(a.append(e),e=d("<div />"))};
d.each(b.options.emoticons.dropdown,f);0<e.children().length&&a.append(e);if("undefined"!==typeof b.options.emoticons.more){var h=d(this._('<a class="sceditor-more">{0}</a>',this._("More"))).click(function(){var g=d.extend({},b.options.emoticons.dropdown,b.options.emoticons.more);a=d("<div />");e=d("<div />");d.each(g,f);0<e.children().length&&a.append(e);b.createDropDown(c,"insertemoticon",a)});a.append(h)}b.createDropDown(c,"insertemoticon",a)},keyPress:function(c,b){var a=null,e=-1,f=this;b.contentWindow&&
b.contentWindow.getSelection&&(a=b.contentWindow.getSelection().getRangeAt(0));if(null!=a&&a.startContainer){f.allEmoticonCache||(f.allEmoticonCache=d.extend({},f.options.emoticons.more,f.options.emoticons.dropdown,f.options.emoticons.hidden));f.longestEmoticonCode||(f.longestEmoticonCode=0,d.each(f.allEmoticonCache,function(a){a.length>f.longestEmoticonCode&&(f.longestEmoticonCode=a.length)}),f.options.emoticonsCompat&&(f.longestEmoticonCode+=1));var h=String.fromCharCode(c.which),g=f.options.emoticonsCompat?
/\s/.test(h):!1,i=a.startContainer.textContent.substr(0,a.startOffset),k=a.startContainer.textContent.substr(a.startOffset,f.longestEmoticonCode),j=i+h+k;d.each(f.allEmoticonCache,function(d,i){if(-1<(e=j.indexOf(d,a.startOffset-d.length))){if(f.options.emoticonsCompat){var l=RegExp("(\\s{1})"+f.regexEscape(d)+"(?=\\s{1})","gm");if(g&&-1<(h+k).indexOf(d)||!l.test(j))return}a=a.cloneRange();a.setStart(a.startContainer,e);a.setEnd(a.startContainer,e+d.length-(g?0:1));a.deleteContents();l=b.contentDocument.createElement("div");
l.innerHTML='<img src="'+i+'" data-sceditor-emoticon="'+d+'" />';l=l.children[0];a.insertNode(l);a=a.cloneRange();a.setStartAfter(l);b.contentWindow.getSelection().removeAllRanges();b.contentWindow.getSelection().addRange(a);g||(c.preventDefault(),c.stopPropagation());return!1}})}},tooltip:"Insert an emoticon"},youtube:{exec:function(c){var b=this,a=d(this._('<form><div><label for="link">{0}</label> <input type="text" id="link" value="http://" /></div></form>',this._("Video URL:"))).submit(function(){return!1});
a.append(d(this._('<div><input type="button" class="button" value="{0}" /></div>',this._("Insert"))).click(function(a){var c=d(this).parent("form").find("#link").val();""!==c&&"http://"!==c&&(c=c.replace(/^[^v]+v.(.{11}).*/,"$1"),b.wysiwygEditorInsertHtml('<iframe width="560" height="315" src="http://www.youtube.com/embed/'+c+'?wmode=opaque" data-youtube-id="'+c+'" frameborder="0" allowfullscreen></iframe>'));b.closeDropDown(!0);a.preventDefault()}));b.createDropDown(c,"insertlink",a)},tooltip:"Insert a YouTube video"},
date:{exec:function(){var c=new Date,b=c.getYear(),a=c.getMonth()+1,c=c.getDate();2E3>b&&(b=1900+b);10>a&&(a="0"+a);10>c&&(c="0"+c);this.wysiwygEditorInsertHtml("<span>"+this.options.dateFormat.replace(/year/i,b).replace(/month/i,a).replace(/day/i,c)+"</span>")},tooltip:"Insert current date"},time:{exec:function(){var c=new Date,b=c.getHours(),a=c.getMinutes(),c=c.getSeconds();10>b&&(b="0"+b);10>a&&(a="0"+a);10>c&&(c="0"+c);this.wysiwygEditorInsertHtml("<span>"+b+":"+a+":"+c+"</span>")},tooltip:"Insert current time"},
print:{exec:"print",tooltip:"Print"},source:{exec:function(){this.toggleTextMode()},txtExec:function(){this.toggleTextMode()},tooltip:"View source"}};d.sceditor.dom={traverse:function(c,b,a,d,f){if(c)for(c=f?c.lastChild:c.firstChild;null!=c;){if(!a&&!1===b(c)||!d&&!1===this.traverse(c,b,a,d,f)||a&&!1===b(c))return!1;c=f?c.previousSibling:c.nextSibling}},rTraverse:function(c,b,a,d){this.traverse(c,b,a,d,!0)},isInline:function(c,b){var a=(window.getComputedStyle?window.getComputedStyle(c):c.currentStyle).display;
return b?"block"!==a:"inline"===a},copyCSS:function(c,b){for(var a="font-size,color,font-family,font-wieght,font-style,text-decoration".split(","),e=a.length,f=d(c),h=d(b);e--;)h.css(a[e],f.css(a[e]))},fixNesting:function(c){var b=this;b.traverse(c,function(a){if(1===a.nodeType&&!b.isInline(a)&&b.isInline(a.parentNode)){var c;for(c=a;b.isInline(c.parentNode);)c=c.parentNode;var d=c.parentNode,h=b.extractContents(c,a);b.copyCSS(a,a);d.insertBefore(h,c);d.insertBefore(a,c)}})},findCommonAncestor:function(c,
b){return d(c).parents().has(d(b)).first()},extractContents:function(c,b){var a=this,d=a.findCommonAncestor(c,b),f=!1,h=!1;return function i(d){var e=c.ownerDocument.createDocumentFragment();a.traverse(d,function(a){if(h||a===b&&f)return h=!0,!1;a===c&&(f=!0);var d;f?(jQuery.contains(a,b)&&1===a.nodeType&&(d=i(a),a=a.cloneNode(!1),a.appendChild(d)),e.appendChild(a)):jQuery.contains(a,c)&&1===a.nodeType&&(d=i(a),a=a.cloneNode(!1),a.appendChild(d),e.appendChild(a))});return e}(null===d?null:d.get(0))}};
d.sceditor.commandExists=function(c){return"undefined"!==typeof d.sceditor.commands[c]};d.sceditor.setCommand=function(c,b,a,e){if(!c||!b)return!1;d.sceditor.commandExists(c)||(d.sceditor.commands[c]={});d.sceditor.commands[c].exec=b;a&&(d.sceditor.commands[c].tooltip=a);e&&(d.sceditor.commands[c].keyPress=e);return!0};d.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|undo,redo|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|print,source",
style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:"en",emoticonsCompat:!1,emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",
":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",
":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null};d.fn.sceditor=function(c){return this.each(function(){new d.sceditor(this,
c)})}})(jQuery);(function(d){d.sceditorBBCodePlugin=function(c,b){var a=this,e,f,h;a.bbcodes=d.sceditorBBCodePlugin.bbcodes;var g={},i={},k={ul:["li"],ol:["li"],table:["tr","th"],tr:["td"],th:["td"],code:[],youtube:[]};e=function(c,b,e){var f,e=!!e;if(!i[e])return b;d.each(i[e],function(e,g){if(!("a"===c.get(0).nodeName.toLowerCase()&&("color"===e||"text-decoration"===e))&&!("code"===c.get(0).nodeName.toLowerCase()&&"font-family"===e))f=c.css(e),c.parent().css(e)!==f&&d.each(g,function(e,g){if(null===g||-1<d.inArray(f.toString(),
g))b=d.isFunction(a.bbcodes[e].format)?a.bbcodes[e].format.call(a,c,b):h(a.bbcodes[e].format,b)})});return b};f=function(c,b,e){var f=c.get(0).nodeName.toLowerCase(),e=!!e;g[f]&&g[f][e]&&d.each(g[f][e],function(e,f){if(null!==f){var g=!1;d.each(f,function(a,b){if(!("undefined"===typeof c.attr(a)||null!==b&&0>d.inArray(c.attr(a),b)))return g=!0,!1});if(!g)return}b=d.isFunction(a.bbcodes[e].format)?a.bbcodes[e].format.call(a,c,b):h(a.bbcodes[e].format,b)});!e&&/^(br|div|p)$/.test(f)&&(b+="\n");return b};
h=function(){var a=arguments;return a[0].replace(/\{(\d+)\}/g,function(c,b){return"undefined"!==typeof a[b-0+1]?a[b-0+1]:"{"+b+"}"})};a.stripQuotes=function(a){return a.replace(/^["']+/,"").replace(/["']+$/,"")};a.getHtmlHandler=function(b,c){return a.elementToBbcode(c)};a.elementToBbcode=function(a){return function q(a,c){var b="";d.sceditor.dom.traverse(a,function(a){var g=d(a),h="",i=a.nodeName.toLowerCase(),j=k[i],l=!0;"object"===typeof c&&((l=-1<d.inArray(i,c))||(j=c));3!==a.nodeType?g.hasClass("sceditor-ignore")||
("iframe"!==i&&(h=q(a,j)),l?(g.is("code")||(h=e(g,h),h=f(g,h),h=e(g,h,!0)),b+=f(g,h,!0)):b+=h):b+=a.nodeValue},!1,!0);return b}(a.get(0))};a.getTextHandler=function(b){for(var c=/\[([^\[\s=]*?)(?:([^\[]*?))?\]((?:[\s\S(?!=\[\\\1)](?!\[\1))*?)\[\/(\1)\]/g,e=/(\S+)=((?:(?:(["'])(?:\\\3|[^\3])*?\3))|(?:[^'"\s]+))/g,f,g=function(b,c,f,g){var i={},j;if(f)if(f=d.trim(f),"="===f.charAt(0)&&1>=f.split("=").length-1||"url"===c)i.defaultAttr=a.stripQuotes(f.substr(1));else for("="===f.charAt(0)&&(f="defaultAttr"+
f);j=e.exec(f);)i[j[1].toLowerCase()]=a.stripQuotes(j[2]);return!a.bbcodes[c]?b:d.isFunction(a.bbcodes[c].html)?a.bbcodes[c].html.call(a,c,i,g):h(a.bbcodes[c].html,g)},b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"").replace(/(\[\/?(?:left|center|right|justify)\])\n/g,"$1").replace(/\n/g,"<span><br /></span>");b!==f;)f=b,b=b.replace(c,g);b=b.replace(/\[hr\]/gi,"<hr>");return b.replace(/ {2}(?=([^<\>]*?<|[^<\>]*?$))/g," &nbsp;")};a.options=d.extend({},d.sceditor.defaultOptions,
d.sceditorBBCodePlugin.defaultOptions,b);(function(){d.each(a.bbcodes,function(b){"undefined"!==typeof a.bbcodes[b].tags&&d.each(a.bbcodes[b].tags,function(c,d){var e=!!a.bbcodes[b].isBlock;g[c]=g[c]||{};g[c][e]=g[c][e]||{};g[c][e][b]=d});"undefined"!==typeof a.bbcodes[b].styles&&d.each(a.bbcodes[b].styles,function(c,d){var e=!!a.bbcodes[b].isBlock;i[e]=i[e]||{};i[e][c]=i[e][c]||{};i[e][c][b]=d})})})();new d.sceditor(c,d.extend({},a.options,{getHtmlHandler:a.getHtmlHandler,getTextHandler:a.getTextHandler}))};
d.sceditorBBCodePlugin.bbcodes={b:{styles:{"font-weight":"bold,bolder,401,700,800,900".split(",")},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",
html:"<sup>{0}</sup>"},font:{styles:{"font-family":null},format:function(c,b){return c.css("font-family")===this.options.defaultFont?b:"[font="+this.stripQuotes(c.css("font-family"))+"]"+b+"[/font]"},html:function(c,b,a){return'<font face="'+b.defaultAttr+'">'+a+"</font>"}},size:{styles:{"font-size":null},format:function(c,b){var a=c.css("fontSize"),d=1;if(a===this.options.defaultSize)return b;-1<a.indexOf("px")?(a=a.replace("px","")-0,12<a&&(d=2),15<a&&(d=3),17<a&&(d=4),23<a&&(d=5),31<a&&(d=6),47<
a&&(d=7)):d=a;return"[size="+d+"]"+b+"[/size]"},html:function(c,b,a){return'<font size="'+b.defaultAttr+'">'+a+"</font>"}},color:{styles:{color:null},format:function(c,b){var a=function(a){function b(a){a=parseInt(a,10);if(isNaN(a))return"00";a=Math.max(0,Math.min(a,255)).toString(16);return 2>a.length?"0"+a:a}var c;return(c=a.match(/rgb\((\d+),\s*?(\d+),\s*?(\d+)\)/i))?"#"+b(c[1])+b(c[2]-0)+b(c[3]-0):a}(c.css("color"));return a===this.options.defaultColor?b:"[color="+a+"]"+b+"[/color]"},html:function(c,
b,a){return'<font color="'+b.defaultAttr+'">'+a+"</font>"}},ul:{tags:{ul:null},isBlock:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{html:"<ul>{0}</ul>"},ol:{tags:{ol:null},isBlock:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{html:"<li>{0}</li>"},table:{tags:{table:null},format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},format:"[th]{0}[/th]",
html:"<th>{0}</th>"},td:{tags:{td:null},format:"[td]{0}[/td]",html:'<td>{0}<br class="sceditor-ignore" /></td>'},emoticon:{tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(c,b){return c.attr("data-sceditor-emoticon")+b},html:"{0}"},horizontalrule:{tags:{hr:null},format:"[hr]{0}",html:"<hr />"},img:{tags:{img:{src:null}},format:function(c,b){return"undefined"!==typeof c.attr("data-sceditor-emoticon")?b:"[img"+("="+d(c).width()+"x"+d(c).height())+"]"+c.attr("src")+"[/img]"},html:function(c,
b,a){c="";"undefined"!==typeof b.width&&(c+=' width="'+b.width+'"');"undefined"!==typeof b.height&&(c+=' height="'+b.height+'"');"undefined"!==typeof b.defaultAttr&&(b=b.defaultAttr.split(/x/i),c=' width="'+b[0]+'" height="'+(2===b.length?b[1]:b[0])+'"');return"<img "+c+' src="'+a+'" />'}},url:{tags:{a:{href:null}},format:function(c,b){return"mailto:"===c.attr("href").substr(0,7)?"[email="+c.attr("href").substr(7)+"]"+b+"[/email]":"[url="+decodeURI(c.attr("href"))+"]"+b+"[/url]"},html:function(c,
b,a){if("undefined"===typeof b.defaultAttr||0===b.defaultAttr.length)b.defaultAttr=a;return'<a href="'+encodeURI(b.defaultAttr)+'">'+a+"</a>"}},email:{html:function(c,b,a){"undefined"===typeof b.defaultAttr&&(b.defaultAttr=a);return'<a href="mailto:'+b.defaultAttr+'">'+a+"</a>"}},quote:{tags:{blockquote:null},isBlock:!0,format:function(c,b){var a="",e=this;1===d(c).children("cite:first").length&&(a="="+d(c).children("cite:first").text(),b="",d(c).children("cite:first").remove(),d(c).contents().each(function(){b+=
e.elementToBbcode(d(this))}));return"[quote"+a+"]"+b+"[/quote]"},html:function(c,b,a){"undefined"!==typeof b.defaultAttr&&(a="<cite>"+b.defaultAttr+"</cite>"+a);return"<blockquote>"+a+"</blockquote>"}},code:{tags:{code:null},isBlock:!0,format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left"]},isBlock:!0,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center"]},isBlock:!0,format:"[center]{0}[/center]",
html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right"]},isBlock:!0,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify"]},isBlock:!0,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{tags:{iframe:{"data-youtube-id":null}},format:function(c,b){return!c.attr("data-youtube-id")?b:"[youtube]"+c.attr("data-youtube-id")+"[/youtube]"},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'}};
d.sceditorBBCodePlugin.commandExists=function(c){return"undefined"!==typeof d.sceditorBBCodePlugin.bbcodes[c]};d.sceditorBBCodePlugin.setCommand=function(c,b,a,e,f){if(!c||!e||!f)return!1;d.sceditorBBCodePlugin.commandExists(c)||(d.sceditorBBCodePlugin.bbcodes[c]={});d.sceditorBBCodePlugin.bbcodes[c].format=e;d.sceditorBBCodePlugin.bbcodes[c].html=f;b&&(d.sceditorBBCodePlugin.bbcodes[c].tags=b);a&&(d.sceditorBBCodePlugin.bbcodes[c].styles=a);return!0};d.sceditorBBCodePlugin.defaultOptions={defaultSize:13,
defaultColor:"#111111",defaultFont:"Verdana, Arial, Helvetica, sans-serif"};d.fn.sceditorBBCodePlugin=function(c){return this.each(function(){new d.sceditorBBCodePlugin(this,c)})}})(jQuery);
